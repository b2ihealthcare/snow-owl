<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="B2i Healthcare">
<title>Snow Owl Server Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Snow Owl Server Documentation</h1>
<div class="details">
<span id="author" class="author">B2i Healthcare</span><br>
<span id="email" class="email"><a href="mailto:support@b2i.sg">support@b2i.sg</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_software_requirements">Software requirements</a>
<ul class="sectlevel2">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_components">Components</a>
<ul class="sectlevel3">
<li><a href="#_operating_system">Operating system</a></li>
<li><a href="#_database_server_software">Database server software</a></li>
<li><a href="#_jdk">JDK</a></li>
<li><a href="#_ldap">LDAP</a></li>
<li><a href="#_task_tracking">Task tracking</a></li>
<li><a href="#_reasoners">Reasoners</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_installation_guide">Installation guide</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">Introduction</a></li>
<li><a href="#_components_2">Components</a>
<ul class="sectlevel3">
<li><a href="#_operating_system_2">Operating system</a></li>
<li><a href="#_database_server_software_2">Database server software</a></li>
<li><a href="#_jdk_2">JDK</a></li>
<li><a href="#_ldap_2">LDAP</a></li>
<li><a href="#_task_tracking_2">Task tracking</a></li>
</ul>
</li>
<li><a href="#_snow_owl_server">Snow Owl Server</a></li>
</ul>
</li>
<li><a href="#_configuration_guide">Configuration guide</a>
<ul class="sectlevel2">
<li><a href="#_introduction_3">Introduction</a></li>
<li><a href="#_components_3">Components</a>
<ul class="sectlevel3">
<li><a href="#_operating_system_3">Operating system</a></li>
<li><a href="#_database_server_software_3">Database server software</a></li>
<li><a href="#_ldap_3">LDAP</a>
<ul class="sectlevel4">
<li><a href="#_setting_up_a_connection_from_apache_directory_studio">Setting up a connection from Apache Directory Studio</a></li>
<li><a href="#_creating_a_partition_for_snow_owl_server">Creating a partition for Snow Owl Server</a></li>
<li><a href="#_using_ldif_dumps">Using LDIF dumps</a></li>
<li><a href="#_creating_a_new_user_from_directory_studio">Creating a new user from Directory Studio</a></li>
</ul>
</li>
<li><a href="#_task_tracking_3">Task Tracking</a>
<ul class="sectlevel4">
<li><a href="#_finishing_the_installation">Finishing the installation</a></li>
<li><a href="#_administration_of_bugzilla">Administration of Bugzilla</a></li>
<li><a href="#_product_setup">Product setup</a></li>
<li><a href="#_authentication_against_ldap">Authentication against LDAP</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_snow_owl_server_2">Snow Owl Server</a>
<ul class="sectlevel3">
<li><a href="#_db_connection">DB connection</a></li>
<li><a href="#_file_authentication">File Authentication</a></li>
<li><a href="#_ldap_authentication">LDAP Authentication</a></li>
<li><a href="#_memory_settings">Memory settings</a></li>
<li><a href="#_osgi_console">OSGi console</a></li>
<li><a href="#_web_server_configuration">Web Server Configuration</a></li>
<li><a href="#_web_server_administrative_console_application">Web Server Administrative Console application</a></li>
<li><a href="#_configuration_reference">Configuration reference</a>
<ul class="sectlevel4">
<li><a href="#_authentication">Authentication</a></li>
<li><a href="#_repository">Repository</a></li>
<li><a href="#_database">Database</a></li>
<li><a href="#_index">Index</a></li>
<li><a href="#_rpc">RPC</a></li>
<li><a href="#_metrics">Metrics</a></li>
<li><a href="#_snomed_ct">SNOMED CT</a></li>
<li><a href="#_snomed_ct_component_identifier_configuration">SNOMED CT Component Identifier Configuration</a></li>
</ul>
</li>
<li><a href="#_logging">Logging</a></li>
<li><a href="#_virgo_documentation">Virgo documentation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_administration_guide">Administration guide</a>
<ul class="sectlevel2">
<li><a href="#_introduction_4">Introduction</a></li>
<li><a href="#_startup_and_shutdown">Startup and shutdown</a></li>
<li><a href="#_importing_content_from_a_release_archive">Importing content from a release archive</a>
<ul class="sectlevel3">
<li><a href="#_starting_the_import">Starting the import</a>
<ul class="sectlevel4">
<li><a href="#_release_decriptor_file">Release decriptor file</a></li>
</ul>
</li>
<li><a href="#_examples">Examples</a>
<ul class="sectlevel4">
<li><a href="#_international_import">International import</a></li>
<li><a href="#_extension_import">Extension import</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_single_administrator_operations">Single administrator operations</a>
<ul class="sectlevel3">
<li><a href="#_list_of_single_administrator_operations">List of single administrator operations</a></li>
<li><a href="#_list_of_operations_that_can_be_executed_by_regular_users">List of operations that can be executed by regular users</a></li>
<li><a href="#_steps_to_perform_single_admin_operations">Steps to perform single admin operations</a></li>
<li><a href="#_impersonating_users">Impersonating users</a></li>
<li><a href="#_taking_backups">Taking backups</a>
<ul class="sectlevel4">
<li><a href="#__hot_backups">"Hot" backups</a></li>
<li><a href="#__cold_backups">"Cold" backups</a></li>
<li><a href="#_backing_up_and_restoring_data_in_the_issue_tracker">Backing up and restoring data in the issue tracker</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_introduction_5">Introduction</a></li>
<li><a href="#_general_2">General</a>
<ul class="sectlevel3">
<li><a href="#_getting_help">Getting help</a></li>
<li><a href="#_disconnecting_from_the_console">Disconnecting from the console</a></li>
</ul>
</li>
<li><a href="#_local_code_systems">Local code systems</a>
<ul class="sectlevel3">
<li><a href="#_import_local_code_systems_from_a_spreadsheet">Import local code systems from a spreadsheet</a></li>
<li><a href="#_export_local_code_systems_to_a_spreadsheet">Export local code systems to a spreadsheet</a></li>
</ul>
</li>
<li><a href="#_loinc">LOINC</a>
<ul class="sectlevel3">
<li><a href="#_import_loinc_vocabulary_from_a_release_archive">Import LOINC vocabulary from a release archive</a></li>
</ul>
</li>
<li><a href="#_mapping_sets">Mapping sets</a>
<ul class="sectlevel3">
<li><a href="#_import_mapping_sets_from_a_spreadsheet">Import mapping sets from a spreadsheet</a></li>
</ul>
</li>
<li><a href="#_scripting">Scripting</a>
<ul class="sectlevel3">
<li><a href="#_execute_groovy_script">Execute Groovy script</a></li>
</ul>
</li>
<li><a href="#_machine_readable_concept_model">Machine-Readable Concept Model</a>
<ul class="sectlevel3">
<li><a href="#_import_mrcm_rules_from_xmi_file">Import MRCM rules from XMI file</a></li>
<li><a href="#_export_mrcm_rules_to_an_xmi_file">Export MRCM rules to an XMI file</a></li>
</ul>
</li>
<li><a href="#_terminology_registry">Terminology registry</a>
<ul class="sectlevel3">
<li><a href="#_list_all_imported_terminologies">List all imported terminologies</a></li>
</ul>
</li>
<li><a href="#_snomed_ct_owl_ontology_reasoner">SNOMED CT OWL ontology (reasoner)</a>
<ul class="sectlevel3">
<li><a href="#_display_available_reasoners">Display available reasoners</a></li>
<li><a href="#_change_the_active_reasoner">Change the active reasoner</a></li>
<li><a href="#_checking_status_of_available_reasoners">Checking status of available reasoners</a></li>
</ul>
</li>
<li><a href="#_snomed_ct_2">SNOMED CT</a>
<ul class="sectlevel3">
<li><a href="#_import_reference_sets_in_rf2_format_from_a_release_text_file">Import reference sets in RF2 format from a release text file</a></li>
<li><a href="#_import_reference_sets_in_dsv_format">Import reference sets in DSV format</a></li>
</ul>
</li>
<li><a href="#_value_domain">Value Domain</a>
<ul class="sectlevel3">
<li><a href="#_import_value_domains_from_a_umls_svs_xml_file">Import value domains from a UMLS SVS XML file</a></li>
</ul>
</li>
<li><a href="#_diagnostics_and_maintenance">Diagnostics and maintenance</a></li>
<li><a href="#_session_management">Session management</a>
<ul class="sectlevel3">
<li><a href="#_display_connected_users_and_session_identifiers">Display connected users and session identifiers</a></li>
<li><a href="#_send_message_to_users">Send message to users</a></li>
<li><a href="#_restrict_user_logins">Restrict user logins</a></li>
<li><a href="#_disconnect_users">Disconnect users</a></li>
</ul>
</li>
<li><a href="#_repository_management">Repository management</a>
<ul class="sectlevel3">
<li><a href="#_display_terminology_repositories">Display terminology repositories</a></li>
<li><a href="#_display_currently_held_locks">Display currently held locks</a></li>
<li><a href="#_lock_and_release_areas_of_terminology_stores">Lock and release areas of terminology stores</a></li>
<li><a href="#_forcefully_unlock_stuck_locks">Forcefully unlock stuck locks</a></li>
</ul>
</li>
<li><a href="#_supporting_indexes">Supporting indexes</a>
<ul class="sectlevel3">
<li><a href="#_display_supporting_indexes">Display supporting indexes</a></li>
<li><a href="#_create_snapshot">Create snapshot</a></li>
<li><a href="#_list_snapshots">List snapshots</a></li>
<li><a href="#_list_files_in_snapshots">List files in snapshots</a></li>
<li><a href="#_release_created_snapshot">Release created snapshot</a></li>
</ul>
</li>
<li><a href="#_remote_jobs">Remote jobs</a>
<ul class="sectlevel3">
<li><a href="#_display_remote_jobs">Display remote jobs</a></li>
<li><a href="#_cancel_remote_job">Cancel remote job</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_administrative_rest_api_reference">Administrative REST API reference</a>
<ul class="sectlevel2">
<li><a href="#_introduction_6">Introduction</a></li>
<li><a href="#_rest_api">REST API</a>
<ul class="sectlevel3">
<li><a href="#_write_access_control_via_repository_locks">Write access control via repository locks</a></li>
<li><a href="#_user_notification">User notification</a></li>
<li><a href="#_versioning_and_terminology_indexes">Versioning and terminology indexes</a></li>
</ul>
</li>
<li><a href="#_introduction_7">Introduction</a></li>
<li><a href="#_branching_arrangement">Branching arrangement</a></li>
<li><a href="#_versioning">Versioning</a></li>
<li><a href="#_upgrading_downgrading">Upgrading/Downgrading</a></li>
<li><a href="#_international_version_update">International version update</a></li>
<li><a href="#_data_provisioning_example_for_a_single_extension">Data provisioning example for a single extension</a>
<ul class="sectlevel3">
<li><a href="#_osgi_command_line_interface">OSGi command line interface</a></li>
<li><a href="#_rest_api_2">REST API</a></li>
<li><a href="#_versioning_extension_content">Versioning extension content</a></li>
<li><a href="#_upgrading_extension_content">Upgrading extension content</a></li>
<li><a href="#_downgrading_extension_content">Downgrading extension content</a></li>
</ul>
</li>
<li><a href="#_snomed_ct_swedish_extension_management_example">SNOMED CT Swedish Extension management example</a>
<ul class="sectlevel3">
<li><a href="#_developer_notes">Developer notes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_software_requirements">Software requirements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction">Introduction</h3>
<div class="paragraph">
<p>This document lists the required set of software components necessary to run Snow Owl Server on the x86_64 platform.
Components and the corresponding files to download are listed in the sections below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_components">Components</h3>
<div class="sect3">
<h4 id="_operating_system">Operating system</h4>
<div class="paragraph">
<p>Snow Owl Server requires a <strong>CentOS</strong> or <strong>Red Hat Enterprise Linux Server (RHEL)</strong> release <strong>6</strong> installation. As of
2015-07-17, the latest available release for CentOS is <a href="http://wiki.centos.org/Manuals/ReleaseNotes/CentOS6.6">version 6.6</a>.
We recommend starting with a minimal install using the ISO image named <code>CentOS-6.6-x86_64-minimal.iso</code> and adding packages
later, as required.</p>
</div>
</div>
<div class="sect3">
<h4 id="_database_server_software">Database server software</h4>
<div class="paragraph">
<p>Terminology contents are persisted using the <strong>5.6</strong> series of <strong>MySQL Community Server</strong>, downloadable from
<a href="http://dev.mysql.com/downloads/repo/yum/">MySQL&#8217;s yum repository</a>. Select &#8220;Red Hat Enterprise Linux / Oracle Linux 6
(Architecture independent), RPM package&#8221; with name <code>mysql-community-release-el6-5.noarch.rpm</code> for download.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jdk">JDK</h4>
<div class="paragraph">
<p>Snow Owl Server uses version <strong>7</strong> of the <strong>Java SE Development Kit</strong>; note that runtime checks in the core server component
prevent it from starting on JDK 8. An installable archive of Critical Patch Update <strong>79</strong> can be downloaded from the
<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html">JDK7 download page</a>. Select the
&#8220;Linux x64&#8221; edition named <code>jdk-7u79-linux-x64.rpm</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ldap">LDAP</h4>
<div class="paragraph">
<p>Authentication and authorization of browsers, terminology editors, reviewers and administrators is performed through an
<strong>Apache DS</strong> version <strong>2.0</strong> LDAP server. The package to install can be located by following the download link after
<code>ApacheDS 2.0.0-M12</code> on the <a href="http://directory.apache.org/apacheds/download-old-versions.html">Download Old Versions</a> page.
The file to download is <code>apacheds-2.0.0-M12-x86_64.rpm</code>.</p>
</div>
<div class="paragraph">
<p>Browsing and managing ApacheDS instances can be done through the <strong>Apache Directory Studio</strong> application. We recommend
installing the latest release from the corresponding
<a href="http://directory.apache.org/studio/download-old-versions.html">Downloads Old Versions</a> page on Apache&#8217;s website. Download
<code>Apache Directory Studio 2.0.0-M7</code> for a version compatible with the M12 release of the server.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_tracking">Task tracking</h4>
<div class="paragraph">
<p>When using Snow Owl&#8217;s desktop client, terminology editing tasks can be tracked using <strong>Bugzilla</strong> version <strong>3.6</strong>. (Recent
versions are not guaranteed to work correctly with client integration.) The archived download of Bugzilla can be found
at <a href="https://ftp.mozilla.org/pub/mozilla.org/webtools/archived/bugzilla-3.6.13.tar.gz" class="bare">https://ftp.mozilla.org/pub/mozilla.org/webtools/archived/bugzilla-3.6.13.tar.gz</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Bugzilla requires Perl modules not included in CentOS repositories. See the
<a href="https://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F">usage instructions</a> for the Extra Packages
for Enterprise Linux (<strong>EPEL</strong>) project for adding the required yum repository.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_reasoners">Reasoners</h4>
<div class="paragraph">
<p>Depending on the complexity of the ontology, you may need to use the FaCT&#43;&#43; reasoner, which relies on a native
library component to increase performance. A customized version of FaCT&#43;&#43; exists for Snow Owl, which requires
version <strong>2.12</strong> from the <strong>GNU C Library (glibc)</strong> to be present, which is already included in the OS distributions
described above.</p>
</div>
<div class="paragraph">
<p>Note that the downloadable release of the same reasoner is based on a different (newer) glibc version, which makes it
unsuitable for use within Snow Owl on CentOS/RHEL 6.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_guide">Installation guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">Introduction</h3>
<div class="paragraph">
<p>This document goes through the installation steps of required software listed in &#8220;Software requirements&#8221;.
After finishing the installation of all items, follow &#8220;Configuration guide&#8221; to set up each component to
work with Snow Owl Server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_components_2">Components</h3>
<div class="sect3">
<h4 id="_operating_system_2">Operating system</h4>
<div class="paragraph">
<p>Install Red Hat Enterprise Linux or CentOS using the minimal ISO image. As hardware configurations and the
corresponding exact installation steps can be different from machine to machine, please refer to the
<a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/index.html">installation guide</a>
on Red Hat&#8217;s site for details (covers both distributions).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The text-based installer does not offer all options compared to the graphical one; you may have to connect a physical
monitor, or use the built-in KVM management capabilities of the server (if supported) to perform the installation from the
graphical environment. The installed system only needs an SSH connection for administration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When creating the partition layout, keep in mind that Snow Owl Server requires at least 160 GB of disk space when branched
terminology editing is used extensively.</p>
</div>
<div class="paragraph">
<p>After logging in to the installed system, update installed packages to the latest version and add EPEL as a package
repository for dependencies. For non-CentOS installations, please see the the
<a href="https://fedoraproject.org/wiki/EPEL#How_can_I_use_these_extra_packages.3F">usage instructions</a> on the EPEL wiki.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum update
# reboot
# yum install epel-release <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Works only if CentOS was installed</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a non-login user for Snow Owl Server to run as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># useradd -r -s /sbin/nologin snowowl</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_database_server_software_2">Database server software</h4>
<div class="paragraph">
<p>An extensive installation guide for getting MySQL Community Edition from a yum repository is available at
<a href="http://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/index.html#repo-qg-yum-fresh-install">the MySQL Documentation Library</a>.
The required steps are summarized below.</p>
</div>
<div class="paragraph">
<p>After downloading the RPM package, install MySQL&#8217;s yum repository with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install mysql-community-release-el6-5.noarch.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>The repository for MySQL 5.6 should be enabled by default. Confirm by opening <code>/etc/yum.repos.d/mysql-community.repo</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[mysql56-community]
name=MySQL 5.6 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.6-community/el/5/$basearch/
enabled=1 <i class="conum" data-value="1"></i><b>(1)</b>
...</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Value should be 0 for other releases, 1 for the 5.6 server</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Install MySQL Community Server using yum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install mysql-community-server</pre>
</div>
</div>
<div class="paragraph">
<p>Start the service, wait for first-time initialization to complete:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service mysqld start
Starting MySQL.                                            [  OK  ]</pre>
</div>
</div>
<div class="paragraph">
<p>After a few minutes, check if the database service is still running and enabled at startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service mysqld status
mysqld (pid  1757) is running...</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre># chkconfig mysqld on
# chkconfig --list mysqld
mysqld          0:off   1:off   2:on    3:on    4:on    5:on    6:off</pre>
</div>
</div>
<div class="paragraph">
<p>Go through the secure installation, which removes example and public databases, and sets a new root password for the
database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># mysql_secure_installation
# reboot</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The entered new root password will be used later for configuration and administrative purposes; do not forget this password.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, check the log file <code>/var/log/mysqld.log</code> for any errors.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jdk_2">JDK</h4>
<div class="paragraph">
<p>Download the &#8220;Linux X64&#8221; edition, and install it with yum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install jdk-7u79-linux-x64.rpm</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ldap_2">LDAP</h4>
<div class="paragraph">
<p>Download the 64-bit Linux RPM package, and install it with yum:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install apacheds-2.0.0-M12-x86_64.rpm</pre>
</div>
</div>
<div class="paragraph">
<p>Start the service, check if it is running at startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service apacheds-2.0.0_M12-default start
Starting ApacheDS - default...

# service apacheds-2.0.0_M12-default status
ApacheDS - default is running (1947).

# chkconfig apacheds-2.0.0_M12-default on
# chkconfig --list apacheds-2.0.0_M12-default
apacheds-2.0.0_M12-default   0:off   1:off   2:on    3:on    4:on    5:on    6:off

# reboot</pre>
</div>
</div>
<div class="paragraph">
<p>Check the log files in folder <code>/var/lib/apacheds-2.0.0_M12/default/log</code> for any errors. <code>wrapper.log</code> holds messages
from the service wrapper running at startup and shutdown, while <code>apacheds.log</code> captures log output from the directory
server itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_tracking_2">Task tracking</h4>
<div class="paragraph">
<p>As in the case of MySQL, only the steps required are included below, a more complete installation guide for Bugzilla
can be found at <a href="https://www.bugzilla.org/docs/3.6/en/html/installing-bugzilla.html" class="bare">https://www.bugzilla.org/docs/3.6/en/html/installing-bugzilla.html</a>.</p>
</div>
<div class="paragraph">
<p>Install the Apache2 web server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install httpd

# service httpd start
Starting httpd:                                            [  OK  ]

# service httpd status
httpd (pid  1638) is running...

# chkconfig httpd on
# chkconfig --list httpd
httpd           0:off   1:off   2:on    3:on    4:on    5:on    6:off

# reboot</pre>
</div>
</div>
<div class="paragraph">
<p>Add the following configuration section to <code>/etc/httpd/conf/httpd.conf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;Directory /var/www/html/bugzilla&gt;
    AddHandler cgi-script .cgi
    Options +Indexes +ExecCGI
    DirectoryIndex index.cgi
    AllowOverride Limit
&lt;/Directory&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Reload the httpd service configuration to apply changes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service httpd reload</pre>
</div>
</div>
<div class="paragraph">
<p>Extract the downloaded archive of Bugzilla and move contents into folder <code>/var/www/html</code>, adjust permissions and
SELinux labels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tar xzvf bugzilla-3.6.13.tar.gz
# mv bugzilla-3.6.13 /var/www/html/bugzilla
# chown -Rv apache:apache /var/www/html/bugzilla
# restorecon -Rv /var/www/html/bugzilla</pre>
</div>
</div>
<div class="paragraph">
<p>Check the availability of Perl modules required to get Bugzilla running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># cd /var/www/html/bugzilla
# ./checksetup.pl --check-modules</pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the set of currently installed Perl modules, the check script will list a set of required modules,
another set of optional modules and a database module to use for persisting Bugzilla issues. The preferred way of
installing them is via yum, but the suggested <code>perl install-module.pl</code> commands can also be used for this. On a
clean CentOS 6 system, the following set of packages need to be added for a MySQL client, the required modules and
modules XML-RPC and LDAP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install perl-DBD-MySQL
# yum install perl-Digest-SHA perl-DateTime perl-TimeDate perl-Template-Toolkit perl-Email-Send perl-Email-MIME
perl-Email-MIME-Encodings perl-Email-MIME-Modifier perl-URI
# yum install perl-SOAP-Lite perl-LDAP</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, run <code>checksetup.pl</code> again, so Bugzilla can create its configuration file, <code>/var/www/html/bugzilla/localconfig</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># ./checksetup.pl</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snow_owl_server">Snow Owl Server</h3>
<div class="paragraph">
<p>Unpack the distribution archive into <code>/opt</code>, installing <code>unzip</code> first if not already present; change permissions
on the created folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install unzip
# unzip snowowl-community-{version}-mysql.zip -d /opt
# chown -Rv snowowl:snowowl /opt/snowowl-community_{version}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_guide">Configuration guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_3">Introduction</h3>
<div class="paragraph">
<p>This document helps configuring each installed component for use with Snow Owl Server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_components_3">Components</h3>
<div class="sect3">
<h4 id="_operating_system_3">Operating system</h4>
<div class="paragraph">
<p>Install <code>system-config-firewall-tui</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install dbus dbus-python system-config-firewall-tui
# reboot</pre>
</div>
</div>
<div class="paragraph">
<p>Using the text-based UI, enable these Trusted Services:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SSH</dt>
<dd>
<p>For remote administration of the server</p>
</dd>
<dt class="hdlist1">WWW (HTTP)</dt>
<dd>
<p>For accessing Bugzilla&#8217;s SOAP API and web-based UI</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Also open access to the following ports:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">8080/TCP</dt>
<dd>
<p>Used by Snow Owl Server&#8217;s REST API</p>
</dd>
<dt class="hdlist1">2036/TCP</dt>
<dd>
<p>Used by the Net4J binary protocol connecting Snow Owl clients to the server</p>
</dd>
<dt class="hdlist1">11389/TCP</dt>
<dd>
<p>Used by the LDAP server</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_database_server_software_3">Database server software</h4>
<div class="paragraph">
<p>Edit <code>/etc/my.cnf</code> to adjust settings for the MySQL server. Recommended settings are shown below, but there are lots
of additional tunable settings to choose from depending on the hardware configuration used; please see
<a href="https://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html" class="bare">https://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html</a> for the full set of system variables.</p>
</div>
<div class="listingblock">
<div class="title">/etc/my.cnf</div>
<div class="content">
<pre>#
# The following options will be read by MySQL client applications.
# Note that only client applications shipped by MySQL are guaranteed
# to read this section. If you want your own MySQL client program to
# honor these values, you need to specify it as an option during the
# MySQL client library initialization.
#
[client]
socket = /var/lib/mysql/mysql.sock

[mysqld]

# Remove leading # and set to the amount of RAM for the most important data
# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.
innodb_buffer_pool_size = 5G

# Size of each log file in a log group. You should set the combined size
# of log files to about 25%-100% of your buffer pool size to avoid
# unneeded buffer pool flush activity on log file overwrite. However,
# note that a larger logfile size will increase the time needed for the
# recovery process.
innodb_log_file_size = 1G

# Total number of files in the log group. A value of 2-3 is usually good
# enough.
innodb_log_files_in_group = 3

# Remove leading # to turn on a very important data integrity option: logging
# changes to the binary log between backups.
# log_bin

# These are commonly set, remove the # and set as required.
# basedir = .....
# datadir = .....
# port = .....
# server_id = .....
socket = /var/lib/mysql/mysql.sock

# Remove leading # to set options mainly useful for reporting servers.
# The server defaults are faster for transactions and fast SELECTs.
# Adjust sizes as needed, experiment to find the optimal values.
# join_buffer_size = 128M
# sort_buffer_size = 2M
# read_rnd_buffer_size = 2M

sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES

# Minimum word length to be indexed by the full text search index.
# You might wish to decrease it if you need to search for shorter words.
# Note that you need to rebuild your FULLTEXT index, after you have
# modified this value.
ft_min_word_len = 2

# The maximum size of a query packet the server can handle as well as
# maximum query size server can process (Important when working with
# large BLOBs).  enlarged dynamically, for each connection.
max_allowed_packet = 16M

# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

collation-server=utf8_unicode_ci
character-set-server=utf8

lower_case_table_names=1
transaction-isolation=READ-COMMITTED

[mysqldump]
# Do not buffer the whole result set in memory before writing it to
# file. Required for dumping very large tables
quick
max_allowed_packet = 16M</pre>
</div>
</div>
<div class="paragraph">
<p>Restart the mysql service to make sure changes are picked up:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service mysqld restart
Stopping mysqld:                                           [  OK  ]
Starting mysqld:                                           [  OK  ]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ldap_3">LDAP</h4>
<div class="sect4">
<h5 id="_setting_up_a_connection_from_apache_directory_studio">Setting up a connection from Apache Directory Studio</h5>
<div class="paragraph">
<p>Open Apache Directory Studio, create a new connection using the first button on the &#8220;Connections&#8221; toolbar:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_connection.png" alt="ldap new connection">
</div>
</div>
<div class="paragraph">
<p>Enter connection name, hostname, and port, then hit <code>Next &gt;</code> to go to the next page in the wizard:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_connection_page1.png" alt="ldap new connection page1">
</div>
</div>
<div class="paragraph">
<p>Set authentication method to <code>Simple Authentication</code>, enter Bind DN <code>uid=admin,ou=system</code> and password <code>secret</code>. Click
<code>Check Authentication</code> to make sure the values are accepted, then dismiss the wizard with <code>Finish</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_connection_page2.png" alt="ldap new connection page2">
</div>
</div>
<div class="paragraph">
<p>After connecting, you are advised to change the default password for user <code>system</code>. In order to do so, expand node
<code>ou=system</code> and select the person <code>admin</code>. The editor will now display related user information:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_admin_user_details.png" alt="ldap admin user details">
</div>
</div>
<div class="paragraph">
<p>Double click on <code>userPassword</code> to open the password change dialog, select <code>SSHA-512</code> as the hash method. To see the new
password as it is being entered, check <code>Show next password details</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_change_password.png" alt="ldap change password">
</div>
</div>
<div class="paragraph">
<p>To see if the password was changed successfully:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Close the connection using the third button on the lower left toolbar named <code>Close Connection</code>,</p>
</li>
<li>
<p>Right-click the item representing the connection to open its properties with the context menu item at the bottom,</p>
</li>
<li>
<p>Change the previously entered default bind password to the updated value on the <code>Authentication</code> tab,</p>
</li>
<li>
<p>Re-connect to the server using <code>Open Connection</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_partition_for_snow_owl_server">Creating a partition for Snow Owl Server</h5>
<div class="paragraph">
<p>Right-click on the item representing the connection, and select "Open Configuration":</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_connection_context_menu.png" alt="ldap connection context menu">
</div>
</div>
<div class="paragraph">
<p>An editor opens with the server configuration; select the <code>Partitions</code> tab. An <code>examples</code> partition is added by default,
which should be removed. Add a new partition named <code>snowowl</code> and fill out the details (ID and suffix):</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_configuration.png" alt="ldap configuration">
</div>
</div>
<div class="paragraph">
<p>Save the editor and restart the server to apply changes in partitions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># service apacheds-2.0.0_M12-default restart
Stopping ApacheDS - default...
Stopped ApacheDS - default.
Starting ApacheDS - default...</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_using_ldif_dumps">Using LDIF dumps</h5>
<div class="paragraph">
<p>B2i provided LDAP packages include the following content:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">schema.ldif</dt>
<dd>
<p>LDAP schema to use for authorization (contains definitions for permissionId and role)</p>
</dd>
<dt class="hdlist1">permissions.ldif</dt>
<dd>
<p>All available permissions in the system</p>
</dd>
<dt class="hdlist1">roles.ldif</dt>
<dd>
<p>All available roles in the system</p>
</dd>
<dt class="hdlist1">pm.ldif</dt>
<dd>
<p>Maps permissions to roles</p>
</dd>
<dt class="hdlist1">update.sh</dt>
<dd>
<p>An update script using <code>ldapmodify</code> and <code>ldapadd</code> commands against a running LDAP instance to update it
based on the files above</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Optionally the assembly can contain two additional files:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">users.ldif</dt>
<dd>
<p>All users available in the system</p>
</dd>
<dt class="hdlist1">rm.ldif</dt>
<dd>
<p>Maps roles to users in the system</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The update script will also make use of these files if any of them exist.</p>
</div>
<div class="paragraph">
<p>Install the <code>openldap-clients</code> first to make use of the script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install openldap-clients</pre>
</div>
</div>
<div class="paragraph">
<p>Before updating the LDAP server, it is advised to shut down the service, and create a backup from the contents
of folder <code>/var/lib/apacheds-2.0.0_M12/default</code>, so it can be restored easily if the script fails.</p>
</div>
<div class="paragraph">
<p>Restart the server, then create a new ldif-&lt;version&gt; folder and unzip the contents of the LDIF archive into
this folder. Finally, execute the script to update the contents of LDAP:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># chmod u+x update.sh

# ./update.sh
Not specified LDAP URI parameter, using ldap://localhost:10389
adding new entry "cn=permission, ou=schema"
adding new entry "ou=attributeTypes, cn=permission, ou=schema"
...
modifying entry...</pre>
</div>
</div>
<div class="paragraph">
<p>In case an error occurs, the executed command and the error response will be displayed. Errors will also be logged
to a <code>{file_name}.errors</code> file, where the <code>{file_name}</code> refers to the file being processed (eg. <code>permissions.errors</code>).</p>
</div>
<div class="paragraph">
<p>When executing the script it is possible to get the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ERR_250_ALREADY_EXISTS</code> (or any synonym of ALREADY_EXISTS)</p>
</li>
<li>
<p><code>ERR_54 Cannot add a value which is already present : snomed:compare:automap</code></p>
</li>
<li>
<p><code>ERR_335 Oid 2.25.128424792425578037463837247958458780603.1 for new schema entity is not unique</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is expected as most of the time the LDAP instance will already contain an existing definition of some entries and/or
schema entities. If you notice other errors (either during script execution or when using the LDAP), roll back your instance
to a previous state from a backup.</p>
</div>
<div class="paragraph">
<p>By default the update script will execute against the LDAP instance running locally at <code>ldap://localhost:10389</code>; if
you&#8217;d like to run the script against a remote LDAP server (or the LDAP is listening on a different port), you can do it by
specifying the LDAP_URI parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># ./update.sh ldap://&lt;host&gt;:&lt;port&gt;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_creating_a_new_user_from_directory_studio">Creating a new user from Directory Studio</h5>
<div class="paragraph">
<p>Go to LDAP Browser view, right click on the Domain component (DC) and add new entry via <code>New</code> &gt; <code>New entry</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_context_menu.png" alt="ldap new user context menu">
</div>
</div>
<div class="paragraph">
<p>Create a new entry from scratch:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_new_entry.png" alt="ldap new user new entry">
</div>
</div>
<div class="paragraph">
<p>Select <code>inetOrgPreson</code> object from the wizard, add it as a selected object class:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_class.png" alt="ldap new user class">
</div>
</div>
<div class="paragraph">
<p>Configure the Relative Distinguished Name (RDN). Specify the common name (CN), surname (SN) and unique ID (uid):</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_rdn.png" alt="ldap new user rdn">
</div>
</div>
<div class="paragraph">
<p>Open the added node in an editor, right click in the editor and select <code>New Attribute</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_new_attribute.png" alt="ldap new user new attribute">
</div>
</div>
<div class="paragraph">
<p>Select <code>userPassword</code> attribute, click <code>Finish</code>, then enter user password in the <code>Password Editor</code> dialog:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_password.png" alt="ldap new user password">
</div>
</div>
<div class="paragraph">
<p>Finally, add a <code>uniqueMember</code> attribute to the Administrator group.</p>
</div>
<div class="paragraph">
<p>Select the new user&#8217;s node in the tree, right click and select <code>Copy Entry / DN</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_copy_entry.png" alt="ldap new user copy entry">
</div>
</div>
<div class="paragraph">
<p>Right click the <code>uniqueMember</code> attribute of the <code>Administrator</code> node, select <code>New Value</code> and paste the previously copied DN
of the new user as the value:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/ldap_new_user_add_to_group.png" alt="ldap new user add to group">
</div>
</div>
<div class="paragraph">
<p>The operation takes place after pressing Enter or removing the focus from the edited field.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_task_tracking_3">Task Tracking</h4>
<div class="sect4">
<h5 id="_finishing_the_installation">Finishing the installation</h5>
<div class="paragraph">
<p>Create a MySQL user for Bugzilla using the command-line client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; GRANT SELECT, INSERT, UPDATE, DELETE, INDEX, ALTER, CREATE, LOCK TABLES,
       CREATE TEMPORARY TABLES, DROP, REFERENCES ON bugs.*
       TO bugs@localhost IDENTIFIED BY 'bugzilla_pwd'; <i class="conum" data-value="1"></i><b>(1)</b>

mysql&gt; FLUSH PRIVILEGES;</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>bugzilla_pwd</code> with a generated password</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Return to folder <code>/var/www/html/bugzilla</code> and edit <code>localconfig</code> to reflect the DB user name and password changes:</p>
</div>
<div class="listingblock">
<div class="title">/var/www/html/bugzilla/localconfig</div>
<div class="content">
<pre># Enter your database password here. It's normally advisable to specify
# a password for your bugzilla database user.
# If you use apostrophe (') or a backslash (\) in your password, you'll
# need to escape it by preceding it with a '\' character. (\') or (\)
# (Far simpler just not to use those characters.)
$db_pass = 'bugzilla_pwd';</pre>
</div>
</div>
<div class="paragraph">
<p>Apply the following patch on <code>/var/www/html/bugzilla/Bugzilla/DB/Mysql.pm</code> to make Bugzilla work with MySQL 5.6:</p>
</div>
<div class="listingblock">
<div class="title">Mysql.pm.patch</div>
<div class="content">
<pre>--- Mysql.pm.old        2015-07-23 22:07:27.797000043 +0200
+++ Mysql.pm    2015-07-23 22:10:49.373999897 +0200
@@ -309,8 +309,8 @@
     # works if InnoDB is off. (Particularly if we've already converted the
     # tables to InnoDB.)
     my ($innodb_on) = @{$self-&gt;selectcol_arrayref(
-        q{SHOW VARIABLES LIKE '%have_innodb%'}, {Columns=&gt;[2]})};
-    if ($innodb_on ne 'YES') {
+        q{SHOW ENGINES}, {Columns=&gt;[2]})};
+    if ($innodb_on ne 'YES' &amp;&amp; $innodb_on ne 'DEFAULT') {
         print &lt;&lt;EOT;
 InnoDB is disabled in your MySQL installation.
 Bugzilla requires InnoDB to be enabled.</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, run <code>./checksetup.pl</code> again. Bugzilla should be reachable at <a href="http://localhost/bugzilla" class="bare">http://localhost/bugzilla</a> after configuration is completed. Details
of the administrator user will be requested at the end of the process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>...
Adding a new user setting called 'per_bug_queries'
Adding a new user setting called 'zoom_textareas'
Adding a new user setting called 'csv_colsepchar'
Adding a new user setting called 'state_addselfcc'
Adding a new user setting called 'comment_sort_order'
Adding a new user setting called 'display_quips'

Looks like we don't have an administrator set up yet. Either this is
your first time using Bugzilla, or your administrator's privileges
might have accidentally been deleted.

Enter the e-mail address of the administrator: info@b2international.com <i class="conum" data-value="1"></i><b>(1)</b>
Enter the real name of the administrator: Administrator <i class="conum" data-value="2"></i><b>(2)</b>
Enter a password for the administrator account: <i class="conum" data-value="3"></i><b>(3)</b>
Please retype the password to verify:
info@b2international.com is now set up as an administrator.
Creating initial dummy product 'TestProduct'...

Now that you have installed Bugzilla, you should visit the 'Parameters'
page (linked in the footer of the Administrator account) to ensure it
is set up as you wish - this includes setting the 'urlbase' option to
the correct URL.</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enter the e-mail address of the administrator user</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add a display name for the Bugzilla administrator</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Enter the password of the administrator user</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once Bugzilla has created its table structure, you can increase the maximum table size by executing the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; USE bugzilla
mysql&gt; ALTER TABLE attachments
       AVG_ROW_LENGTH=1000000, MAX_ROWS=20000;</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_administration_of_bugzilla">Administration of Bugzilla</h5>
<div class="paragraph">
<p>See <a href="http://www.bugzilla.org/docs/3.6/en/html/administration.html" class="bare">http://www.bugzilla.org/docs/3.6/en/html/administration.html</a> for a comprehensive list of administrative tasks and options.</p>
</div>
<div class="paragraph">
<p>After logging in with an account that has administrative privileges, click the <code>Administration</code> link on the top. The
general administrative page will appear as shown below:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/bugzilla_administration.png" alt="bugzilla administration">
</div>
</div>
<div class="paragraph">
<p>Core parameters can be set by selecting <code>Parameters</code> on the top left. The following fields are recommended to be adjusted:</p>
</div>
<div class="sect5">
<h6 id="_required_settings">Required Settings</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">urlbase</dt>
<dd>
<p>Set to the the common leading part of all URLs which are related to Bugzilla (ex.: <a href="http://server.domain/bugzilla/" class="bare">http://server.domain/bugzilla/</a>)</p>
</dd>
<dt class="hdlist1">cookiepath</dt>
<dd>
<p>The common path segment of the URL under which Bugzilla cookies are allowed to be read; as noted in the description
above the field, its value should begin with '/' (ex.: /bugzilla/)</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="_general">General</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">maintainer</dt>
<dd>
<p>The email address entered here is shown on various pages in Bugzilla where contacting the administrator is
suggested</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="_user_authentication">User Authentication</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">requirelogin</dt>
<dd>
<p>Set to On if you want to limit access to registered users only (disabling anonymous browsing of bugs)</p>
</dd>
<dt class="hdlist1">emailregexp and emailregexpdesc</dt>
<dd>
<p>Depending on requirements, the administrator may limit login names to values that are not actual
email addresses. In this case, set the fields as suggested in the description above, ie. <code>^[^@]+</code> and <code>Local usernames, no @ allowed.</code></p>
</dd>
<dt class="hdlist1">createemailregexp</dt>
<dd>
<p>to disable user-initiated registration (requiring the administrator to create each user account by hand), clear
the field&#8217;s contents</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/bugzilla_emailregexp.png" alt="bugzilla emailregexp">
</div>
</div>
</div>
<div class="sect5">
<h6 id="_attachments">Attachments</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">maxattachmentsize</dt>
<dd>
<p>The maximum size in kilobytes for attachments. Change it to <code>10240</code> (10 MB)</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="_dependency_graphs">Dependency Graphs</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">webdotbase</dt>
<dd>
<p>To disable relying on an external service for rendering dependency graphs of issues (as populated by
default), clear the field&#8217;s contents</p>
</dd>
</dl>
</div>
</div>
<div class="sect5">
<h6 id="_email">Email</h6>
<div class="dlist">
<dl>
<dt class="hdlist1">mail_delivery_method</dt>
<dd>
<p>If an SMTP server is available, configure its address and authentication properties below;
otherwise, set this value to <code>None</code> to disable sending mail altogether</p>
</dd>
<dt class="hdlist1">smtpserver</dt>
<dd>
<p>Clear the field&#8217;s contents if no SMTP server is used</p>
</dd>
<dt class="hdlist1">whinedays</dt>
<dd>
<p>Set to 0 if mail delivery is not enabled and/or there&#8217;s no need to send users regular notifications about
their assigned bugs which remained in NEW state</p>
</dd>
<dt class="hdlist1">use-mailer-queue</dt>
<dd>
<p>When set to <code>On</code>, e-mails are sent asynchronously; to use this feature, the jobqueue.pl daemon needs to be started.
For more information on this topic, please see <a href="http://www.bugzilla.org/docs/3.6/en/html/api/jobqueue.html" class="bare">http://www.bugzilla.org/docs/3.6/en/html/api/jobqueue.html</a>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_product_setup">Product setup</h5>
<div class="paragraph">
<p>Bugzilla tracks the authoring aspects of Snow Owl clients in multiple products. Per-product configuration is shown in the following
parts of the guide.</p>
</div>
<div class="paragraph">
<p>Opening the preference page <code>Snow Owl &gt; Bugzilla Products</code> displays the supported products in the client and their
corresponding product names in Bugzilla. If you have different product names added in the issue tracker, you have to
adjust the product name as shown in the image. Make sure to press Enter or click in the table to apply the change in
the field before hitting <code>Apply</code> or <code>OK</code> to apply the changes. Products which are not handled by contributed task
editors are displayed with an empty context view only:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/bugzilla_products.png" alt="bugzilla products">
</div>
</div>
<div class="paragraph">
<p>To match the default value set in client preferences, create a product called <code>Snow Owl Collaborative Editing</code> by clicking <code>Products</code>
on Bugzilla&#8217;s administration page. Add a description, optionally set a version to discern individual releases, and keep <code>Open for bug entry</code>
checked to allow users to file issues under this product. After creating the product, a warning will be issued by Bugzilla to create a
component as well. Add the following components with the <code>Component</code>, <code>Component description</code> and <code>Default assignee</code> fields populated:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single author with single reviewer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single author with single reviewer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with single reviewer  Dual authoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with single reviewer  Dual authoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with single reviewer  Dual blind authoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with single reviewer  Dual blind authoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with dual reviewers  Dual authoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with dual reviewers  Dual authoring</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with dual reviewers  Dual blind authoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual authors with dual reviewers  Dual blind authoring</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<img src="images/bugzilla_add_product.png" alt="bugzilla add product">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/bugzilla_add_component.png" alt="bugzilla add component">
</div>
</div>
<div class="paragraph">
<p>Add custom fields through the web interface (<code>Administration &gt; Custom fields</code>):</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Sortkey</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Editable on Bug Creation</th>
<th class="tableblock halign-left valign-top">In Bugmail on Bug Creation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_artifacttype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Task artifact type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_author_one</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Author one</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">410</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_author_two</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Author two</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">420</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_reviewer_one</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reviewer one</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">430</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_reviewer_two</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reviewer two</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">440</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_adjudicator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adjudicator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">450</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_artifact_properties_source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">991</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_mappingset_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mapping set ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">992</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_valueset_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value domain ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">993</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_is_promoted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Promoted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">995</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_parent_refset_map_target_component_type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference set map target component type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">996</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_parent_refset_referenced_component_type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference set referenced component type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">997</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_parent_refset_identifierconcept_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parent reference set identifier concept id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">998</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cf_refset_identifierconcept_id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference set identifier concept</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Free Text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_authentication_against_ldap">Authentication against LDAP</h5>
<div class="paragraph">
<p>Bugzilla is capable to authenticate against the external LDAP server which Snow Owl Server will use. Setting it up
requires the following steps to be taken:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to <code>Administration &gt; Parameters &gt; LDAP</code> and populate the following fields:</p>
<div class="dlist">
<dl>
<dt class="hdlist1">LDAPserver</dt>
<dd>
<p>hostname:port pair for contacting the server, eg. <code>localhost:10389</code></p>
</dd>
<dt class="hdlist1">LDAPBaseDN</dt>
<dd>
<p>set to <code>dc=snowowl,dc=b2international,dc=com</code></p>
</dd>
<dt class="hdlist1">LDAPuidattribute</dt>
<dd>
<p>set to <code>uid</code></p>
</dd>
<dt class="hdlist1">LDAPmailattribute</dt>
<dd>
<p>set to <code>uid</code></p>
</dd>
</dl>
</div>
</li>
<li>
<p>Click <code>Save Changes</code> to apply changes</p>
</li>
<li>
<p>Go to <code>Administration &gt; Parameters &gt; User Authentication</code>, scroll down to <code>user_verify_class</code> and make <code>LDAP</code> the top-most
item</p>
</li>
<li>
<p>Click <code>Save Changes</code> to finish</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To test, click the <code>Log Out</code> link at the top and try to log in with your bugzilla username and LDAP password. If it was sucessful,
you should see bugzilla&#8217;s landing page. If you see an error message about not able to connect to the LDAP server, then run the
following command as root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># setsebool -P httpd_can_network_connect on</pre>
</div>
</div>
<div class="paragraph">
<p>This will allow Apache to make network connections.</p>
</div>
<div class="paragraph">
<p>If LDAP is still not working and you are being locked out from bugzilla, you can change back bugzilla to use its internal database for
authentication, instead of LDAP. To do so, edit <code>/var/www/html/bugzilla/data/params</code>, deleting LDAP from the <code>user_verify_class</code> entry:</p>
</div>
<div class="listingblock">
<div class="title">/var/www/html/bugzilla/data/params</div>
<div class="content">
<pre>...
'user_verify_class' =&gt; 'DB',
...</pre>
</div>
</div>
<div class="paragraph">
<p>If users are already entered in the LDAP server, it is important to synchronize Bugzilla&#8217;s user database to contents of LDAP so tasks can be
assigned to all users. Run the following script to perform synchronization:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># cd /var/www/html/bugzilla
# ./contrib/syncLDAP.pl</pre>
</div>
</div>
<div class="paragraph">
<p>For general questions and documentation, please refer to chapter 3.1.10. LDAP Authentication in the documentation:
<a href="http://www.bugzilla.org/docs/3.6/en/html/parameters.html" class="bare">http://www.bugzilla.org/docs/3.6/en/html/parameters.html</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snow_owl_server_2">Snow Owl Server</h3>
<div class="sect3">
<h4 id="_db_connection">DB connection</h4>
<div class="paragraph">
<p>Create a MySQL user for the Snow Owl Server by connecting to the DBMS via the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mysql -u root -p
Enter password: root_pwd <i class="conum" data-value="1"></i><b>(1)</b>

mysql&gt; CREATE USER 'snowowl'@'localhost' IDENTIFIED BY 'snowowl_pwd'; <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>root_pwd</code> with the password for the <code>root</code> user in MySQL</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Replace <code>snowowl_pwd</code> with a generated password for the <code>snowowl</code> user in MySQL</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Save the following shell script to an executable file to create databases and grant privileges for user <code>snowowl</code>:</p>
</div>
<div class="listingblock">
<div class="title">snowowl_create_db.sh</div>
<div class="content">
<pre>Unresolved directive in configuration_guide.adoc - include::scripts/snowowl_create_db.sh[]</pre>
</div>
</div>
<div class="paragraph">
<p>B2i provided MySQL dumps (if present) can be found in <code>/opt/snowowl-community_{version}/resources/*.sql</code> files
after unpacking the installation archive. To load terminology data, save and execute the following script:</p>
</div>
<div class="listingblock">
<div class="title">snowowl_load_db.sh</div>
<div class="content">
<pre>Unresolved directive in configuration_guide.adoc - include::scripts/snowowl_load_db.sh[]</pre>
</div>
</div>
<div class="paragraph">
<p>Update <code>snowowl_config.yml</code> to use LDAP authentication and set the MySQL password for <code>snowowl</code>, created earlier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repository:
  ...

  database:
    ...
    username: snowowl
    password: snowowl <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Update MySQL username and password, if neccessary</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_file_authentication">File Authentication</h4>
<div class="paragraph">
<p>To use file based authentication, configure the <code>auth</code> property to <code>PROP_FILE</code> and the <code>fileAuth</code> configuration object to the desired username/password in the <code>snowowl_config.yml</code> file.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Building Snow Owl produces a ready to use, deployable package with the default passwords (<code>fileAuth</code> and <code>database</code> properties) configured. Usage of the default password configuration is not recommended in production environments.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_ldap_authentication">LDAP Authentication</h4>
<div class="paragraph">
<p>To use the configured LDAP instance, adjust <code>snowowl_jaas_configuration.properties</code> to
include the host name of the LDAP server and the LDAP administrator password:</p>
</div>
<div class="listingblock">
<div class="title">/opt/snowowl-community_{version}/configuration/snowowl_jaas_configuration.properties</div>
<div class="content">
<pre>LDAP {
    org.eclipse.equinox.security.auth.module.ExtensionLoginModule required
        extensionId="com.b2international.snowowl.authentication.ldap.ldapLoginModule"
        ...
        userProvider="ldap://&lt;ldap_host&gt;:10389/" <i class="conum" data-value="1"></i><b>(1)</b>
        usePool=false
        snowOwlBase="dc=snowowl,dc=b2international,dc=com"
        bindDnUser="uid=admin,ou=system"
        bindDnPassword="secret" <i class="conum" data-value="2"></i><b>(2)</b>
        ...
};</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Replace <code>&lt;ldap_host&gt;</code> with the host name of the LDAP server to connect to</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Replace <code>secret</code> with the LDAP administrator&#8217;s password</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_memory_settings">Memory settings</h4>
<div class="paragraph">
<p>Heap size used by Snow Owl can be adjusted in <code>dmk.sh</code>; look for the following seciton:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>JAVA_OPTS="$JAVA_OPTS \
    -Xms8g \
    -Xmx10g \
    -XX:MaxPermSize=512m \</pre>
</div>
</div>
<div class="paragraph">
<p><code>Xms</code> sets the minimum heap size, <code>Xmx</code> sets the maximum heap size, and <code>XX:MaxPermsize</code> sets the PermGen space used by the JVM.</p>
</div>
</div>
<div class="sect3">
<h4 id="_osgi_console">OSGi console</h4>
<div class="paragraph">
<p>The OSGi console can be accessed both via ssh and telnet. Configuration settings to for remote access can be found in <code>osgi.console.properties</code>.
The default settings are:</p>
</div>
<div class="listingblock">
<div class="title">/opt/snowowl-community_{version}/repository/ext/osgi.console.properties</div>
<div class="content">
<pre>telnet.enabled=true
telnet.port=2501
telnet.host=localhost
ssh.enabled=true
ssh.port=2502
ssh.host=localhost</pre>
</div>
</div>
<div class="paragraph">
<p>Further information on how to enable/disable the OSGi console can be found here:
<a href="http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch08.html" class="bare">http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch08.html</a>.</p>
</div>
<div class="paragraph">
<p>For opening a telnet connection to the server, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ telnet localhost 2501
Trying ::1...
Connected to localhost.
Escape character is '^]'.
osgi&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_web_server_configuration">Web Server Configuration</h4>
<div class="paragraph">
<p>Snow Owl Server uses Tomcat as its built-in web server for administrative and RESTful services. The configuration
settings for the web server can be found in <code>tomcat-server.xml</code>. Detailed information on configuring the different
elements can be found here: <a href="http://tomcat.apache.org/tomcat-7.0-doc/config/index.html" class="bare">http://tomcat.apache.org/tomcat-7.0-doc/config/index.html</a>. The most important settings
are the port numbers for HTTP and HTTPS protocols:</p>
</div>
<div class="listingblock">
<div class="title">/opt/snowowl-community_{version}/configuration/tomcat-server.xml</div>
<div class="content">
<pre>&lt;Service name="Catalina"&gt;
   &lt;Connector port="8080" protocol="HTTP/1.1"
               connectionTimeout="20000"
              redirectPort="8443" /&gt;
   &lt;Connector port="8443" protocol="HTTP/1.1" SSLEnabled="true"
              maxThreads="150" scheme="https" secure="true"
              clientAuth="false" sslProtocol="TLS"
              keystoreFile="configuration/keystore"
              keystorePass="changeit"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_web_server_administrative_console_application">Web Server Administrative Console application</h4>
<div class="paragraph">
<p>The Admin Console is a web application for managing the Virgo Server instance powering Snow Owl Server. The default
location of the admin console is at <a href="http://localhost:8080/admin" class="bare">http://localhost:8080/admin</a>.</p>
</div>
<div class="paragraph">
<p>The Admin Console is a password-protected page; to configure users allowed to access the Admin Console, change settings
in file <code>org.eclipse.virgo.kernel.users.properties</code>. The username-password pair configured by default is <code>user=admin, pwd=adminpwd</code>:</p>
</div>
<div class="listingblock">
<div class="title">/opt/snowowl-community_{version}/configuration/org.eclipse.virgo.kernel.users.properties</div>
<div class="content">
<pre> ##################
 # User definitions
 ##################
 user.admin=adminpwd

 ##################
 # Role definitions
 ##################
 role.admin=admin</pre>
</div>
</div>
<div class="paragraph">
<p>More information on administrative user access control can be found on the following pages:
<a href="http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch09.html" class="bare">http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch09.html</a> and
<a href="http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.0.M04/docs/virgo-user-guide/html/ch13s06.html#configuring-authentication" class="bare">http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.0.M04/docs/virgo-user-guide/html/ch13s06.html#configuring-authentication</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_reference">Configuration reference</h4>
<div class="paragraph">
<p>Snow Owl Server comes with a predefined default configuration file, which can be used to tweak various system parameters.
The configuration file is in YAML format, and located at <code>/opt/snowowl-community_{version}/snowowl_config.yml</code>. You
can read more about how to create/write such files here: <a href="http://en.wikipedia.org/wiki/YAML" class="bare">http://en.wikipedia.org/wiki/YAML</a>.</p>
</div>
<div class="paragraph">
<p>The configuration file has a hierarchical structure, which is defined by modules. Different modules can have different
configurations, a module is defined by its name, which should start a line in the file. Configuration parameters in a
module should be indented by two spaces following the module&#8217;s name.</p>
</div>
<div class="paragraph">
<p>The next section contains the reference of our currently supported configuration parameters. Each parameter should be
present in a module configuration as described above.</p>
</div>
<div class="paragraph">
<p>Snow Owl Server refuses to start if the configuration file contains syntactical or structural errors. The cause of the
problem can be found in the <code>log.log</code> file, or in the console if you&#8217;ve redirected the output of the server&#8217;s startup
process.</p>
</div>
<div class="sect4">
<h5 id="_authentication">Authentication</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LDAP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PROP_FILE</code>, <code>LDAP</code> - choose which type of authentication method you want. NOTE: <code>PROP_FILE</code> is supported on standalone environments only.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>authentication:
  type: PROP_FILE</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_repository">Repository</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0.0.0.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host name to bind to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2036</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The port of the chosen network interface to use when listening for connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">numberOfWorkers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3 x NumberOfCores</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of worker threads to assign to a repository during initialization.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">revisionCache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable CDO revision cache to keep data returned from the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">readerPoolCapacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The capacity of the reader pool associated with the SNOMED CT store.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writerPoolCapacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The capacity of the writer pool associated with the SNOMED CT store.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>repository:
  host: 0.0.0.0
  port: 2036</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_database">Database</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>store</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The directory of the embedded database inside the global resources folder where the application should look for the database files by default (if no location parameter is given).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>h2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of the database adapter to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">driverClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.h2.Driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fully qualified name of the driver&#8217;s Java class to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datasourceClass</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.h2.jdbcx.JdbcDataSource</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The fully qualified name of the datasource&#8217;s Java class to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">scheme</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jdbc:h2:</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The scheme to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">location</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The location of the database when connecting to it. If not set then in embedded mode the default directory parameter will be used as location.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">username</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username of the database user to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password of the database user to use when connecting to the database.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">settings</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Other database specific JDBC settings to use when connecting to the database.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>repository:
  database:
    directory: store
    type: h2
    username: admin
    password: admin</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_index">Index</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commitInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>15000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The hard commit interval of an index in milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">translogSyncInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The sync interval of the transaction log in milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryWarnThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>400</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the warn log when querying data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryInfoThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the info log when querying data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryDebugThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the debug log when querying data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">queryTraceThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the trace log when querying data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetchWarnThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>200</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the warn log when fetching data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetchInfoThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the info log when fetching data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetchDebugThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>50</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the debug log when fetching data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetchTraceThreshold</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The threshold of the trace log when fetching data.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>repository:
  index:
    commitInterval: 5000
    translogSyncInterval: 1000
    queryWarnThreshold: 400
    fetchInfoThreshold: 100</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_rpc">RPC</h5>
<div class="paragraph">
<p>RPC is a custom protocol implementation used to solve request-response based communication between a client and a server.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Changing these settings is not recommended and currently unsupported in production environments.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>, <code>false</code>, <code>ON</code>, <code>OFF</code> - enable or disable verbose logging during RPC communication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compressed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>, <code>false</code>, <code>ON</code>, <code>OFF</code> - enable or disable GZIP compression of the communication.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>rpc:
  logging: true
  compressed: false</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_metrics">Metrics</h5>
<div class="paragraph">
<p>Snow Owl can measure and report execution times (and other metrics in the future) of executed requests.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>, <code>false</code>, <code>ON</code>, <code>OFF</code> - enable or disable metrics in the application</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_snomed_ct">SNOMED CT</h5>
<div class="paragraph">
<p>Configuration of SNOMED CT terminology services.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">readerPoolCapacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The capacity of the reader pool associated with the SNOMED CT store.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">writerPoolCapacity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The capacity of the writer pool associated with the SNOMED CT store.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>en-gb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>en-gb</code>, <code>en-us</code>, <code>en-sg</code> - The language code to use for SNOMED CT Descriptions. Descriptions with membership of the chosen
language&#8217;s reference set will be used runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxReasonerCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of reasoners permitted to do computation simultaneously. Minimum <code>1</code>, maximum <code>3</code> is allowed. If the value is set to
<code>1</code>, classification requests will be processed in a sequential fashion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxReasonerResults</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of inferred taxonomies that should be kept in memory after the reasoner completes the computational stage. The user can only
choose to save the results of the classification run if the corresponding taxonomy instance is still present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxReasonerRuns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of classification runs of which details should be preserved on disk. Details include inferred and redundant relationships,
the list of equivalent concepts found during classification, and classification run metadata (start and end times, status, requesting user,
reasoner used for this run).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">showReasonerUsageWarning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'true' will display a dialog if any user selects a non-ELK reasoner, citing memory and compatibility problems, also recommending to contact B2i.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">concreteDomainSupport</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'true' will turn on support for concrete domains.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inferredEditingEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'true' will enable manual editing of inferred relationships and concrete domain elements.</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre>snomed:
  language: en-gb
  maxReasonerCount: 1
  maxReasonerResults: 20
  showReasonerUsageWarning: true
  concreteDomainSupport: true
  inferredEditingEnabled: false</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_snomed_ct_component_identifier_configuration">SNOMED CT Component Identifier Configuration</h5>
<div class="paragraph">
<p>Snow Owl&#8217;s SNOMED CT identifier service an be configured to be either using the built-in or IHTSDO&#8217;s external Component Identifier Service (CIS).  The configuration needs to be placed within the <strong>snomed/ids</strong> section.
If omitted, then default configuration will be used, which is the built-in (embedded) service based on the index store allocating ids in a sequential fashion.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMBEDDED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EMBEDDED</code> or <code>CIS</code> - The service used to generate ids.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INDEX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INDEX</code> or <code>MEMORY</code> - The source of the generated ids.  <code>MEMORY</code> is used for testing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strategy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEQUENTIAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SEQUENTIAL</code> or <code>RANDOM</code> - The strategy of the id generation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisBaseUrl</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The service&#8217;s URL with port and without context root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisContextRoot</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The context root of the id generation service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisUserName</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The registered user name at the CIS site.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisPassword</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password for the registered user name at the CIS site.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisClientSoftwareKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Snow Owl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The client software key to be persisted within CIS as reference.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisNumberOfPollTries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of tries when polling jobs of bulk requests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisTimeBetweenPollTries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time to wait between 2 job polling actions It is in milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisNumberOfReauthTries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of re-authentication attempts when a 401 Not authorized response is received.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cisMaxConnections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of simultaneous connections that Snow Owl can make to the CIS host via HTTP.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxIdGenerationAttempts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of attempts any non-CIS ID generator will take to generate a single SNOMED CT identifier, if exceeded it throws an exception.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example for using the built-in service with random ids using the index as the source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>snomed:
  ...
  ids:
    service: EMBEDDED
    source: INDEX
    strategy : RANDOM
    cisBaseUrl : &lt;cis_host_and_port&gt;
    cisContextRoot : api
    cisUserName : &lt;your-cis-username&gt;
    cisPassword : &lt;your-cis-password&gt;
    cisClientSoftwareKey : Snow Owl dev. deployment
    cisNumberOfPollTries : 1
    cisTimeBetweenPollTries : 1000
    cisMaxConnections: 100
  ...</pre>
</div>
</div>
<div class="paragraph">
<p>Example for using IHTSDO&#8217;s external CIS service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>snomed:
  ...
  ids:
    service : CIS
    cisBaseUrl : &lt;cis_host_and_port&gt;
    cisContextRoot : api
    cisUserName : &lt;your-cis-username&gt;
    cisPassword : &lt;your-cis-password&gt;
    cisClientSoftwareKey : Snow Owl dev. deployment
    cisNumberOfPollTries : 1
    cisTimeBetweenPollTries : 1000
    cisMaxConnections: 100
  ...</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_logging">Logging</h4>
<div class="paragraph">
<p>Log files are stored under <code>./opt/snowowl-community_{version}/serviceability</code> directory of the Snow Owl server.
The following log files are created:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>logs/log.log</code></dt>
<dd>
<p>Generic system trace log file, all log messages are written into this file. In case the file reaches a
pre-defined maximum size, the system will create additional files named <code>log_1.log</code>, <code>log_2.log</code>, etc. This log serves
two main purposes:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It provides global trace files that capture high-volume information regarding the Virgos internal events. The files
are intended for use by support personnel to diagnose runtime problems.</p>
</li>
<li>
<p>It provides application trace files that contain application-generated output. This includes output generated using
popular logging and tracing APIs including the OSGi LogService, as well as output generated by calls to <code>System.out</code> and
<code>System.err</code>. These files are intended for use by application developers and system administrators. An application is
defined as a scope so a single bundle will not get its own log file unless it is a Web application Bundle or is included
in a scoped plan or a par file.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1"><code>logs/access/*.log</code></dt>
<dd>
<p>Web container access log files in the same format as those created by standard web servers. The log
files are prefixed with the string <code>localhost_access_log</code>, have a suffix of <code>.txt</code>, use a standard format for identifying
what should be logged, and do not include DNS lookups of the IP address of the remote host.</p>
</dd>
<dt class="hdlist1"><code>eventlogs/eventlog.log</code></dt>
<dd>
<p>The <code>EVENT_LOG_FILE</code> appender logs only important events and thus the volume of information is
lower.</p>
</dd>
<dt class="hdlist1"><code>logs/snowowl/snowowl_user_audit.log</code></dt>
<dd>
<p>Events with business significance will be logged in this file.</p>
</dd>
<dt class="hdlist1"><code>logs/snowowl/snowowl_user_access.log</code></dt>
<dd>
<p>User access events are logged in this log file. Both authorized and unauthorized
access is logged.</p>
</dd>
<dt class="hdlist1"><code>logs/snowowl/snowowl_import.log</code></dt>
<dd>
<p>Import processes log into this file detailed information about import.</p>
</dd>
<dt class="hdlist1"><code>logs/snowowl/snowowl_export.log</code></dt>
<dd>
<p>Export processes log into this file detailed information about export.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Detailed information on the configuration on the logging configuration can be found here:
<a href="http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch11.html" class="bare">http://www.eclipse.org/virgo/documentation/virgo-documentation-3.6.1.RELEASE/docs/virgo-user-guide/html/ch11.html</a>.</p>
</div>
<div class="paragraph">
<p>Currently, default logging appenders for the log targets above look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;appender name="LOG_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt;
    &lt;file&gt;serviceability/logs/log.log&lt;/file&gt;
    &lt;rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy"&gt;
        &lt;FileNamePattern&gt;serviceability/logs/log_%i.log&lt;/FileNamePattern&gt;
        &lt;MinIndex&gt;1&lt;/MinIndex&gt;
        &lt;MaxIndex&gt;4&lt;/MaxIndex&gt;
    &lt;/rollingPolicy&gt;
    &lt;triggeringPolicy class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy"&gt;
        &lt;MaxFileSize&gt;10MB&lt;/MaxFileSize&gt;
    &lt;/triggeringPolicy&gt;
    &lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;
        &lt;Pattern&gt;[%d{yyyy-MM-dd HH:mm:ss.SSS}] %-5level %-28.28thread %-64.64logger{64} %X{medic.eventCode} %msg %ex%n&lt;/Pattern&gt;
    &lt;/encoder&gt;
&lt;/appender&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In this setting, the administrator can set the location of the log file, the maximum size of the log file and the
total number of files rolling over. Documentation on the logging configuration settings can be found here: <a href="http://logback.qos.ch" class="bare">http://logback.qos.ch</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_virgo_documentation">Virgo documentation</h4>
<div class="paragraph">
<p>Complete documentation of the Virgo OSGi server can be found here: <a href="http://www.eclipse.org/virgo/documentation" class="bare">http://www.eclipse.org/virgo/documentation</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administration_guide">Administration guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_4">Introduction</h3>
<div class="paragraph">
<p>This document covers administrative and maintenance tasks in Snow Owl Server.</p>
</div>
</div>
<div class="sect2">
<h3 id="_startup_and_shutdown">Startup and shutdown</h3>
<div class="paragraph">
<p>Scripts for starting and stopping a Snow Owl Server instance are located in <code>/opt/snowowl-community_{version}/bin/*.sh</code>
files. Change the active user to <code>snowowl</code> when starting the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># su snowowl -s /bin/bash -c "nohup bin/startup.sh &gt; /dev/null" &amp;
[1] 12473
nohup: ignoring input and redirecting stderr to stdout

# jobs
[1]+  Running    su snowowl -s /bin/bash -c "nohup bin/startup.sh &gt; /dev/null" &amp;</pre>
</div>
</div>
<div class="paragraph">
<p>Note that startup will continue in the background and the server stays running even if the user disconnects from
the server.</p>
</div>
<div class="paragraph">
<p>You can follow the startup sequence by inspecting <code>serviceability/logs/log.log</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># tail -f serviceability/logs/log.log
...
[2015-07-24 02:50:12.753] INFO  start-signalling-2 WE0001I Started web bundle [...]
[2015-07-24 02:50:12.756] INFO  start-signalling-2 DE0005I Started bundle [...]
[2015-07-24 02:50:12.756] INFO  start-signalling-2 Thread context class loader [...]
[2015-07-24 02:50:12.757] INFO  start-signalling-2 DE0005I Started plan 'osgi_server.plan' version '1.0.0'.</pre>
</div>
</div>
<div class="paragraph">
<p>Snow Owl Server finishes the startup procedure after displaying the lines from above. You can connect with a
telnet client to the server and check that everything is working properly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># yum install telnet <i class="conum" data-value="1"></i><b>(1)</b>

# telnet localhost 2501
Trying ::1...
Connected to localhost.
Escape character is '^]'.

osgi&gt; snowowl checkservices
Checking core services...
[...]
Core services are registered properly and available for use.

osgi&gt; disconnect
Disconnect from console? (y/n; default=y) y
Connection closed by foreign host.</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install the client first (if not already present)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The server can be stopped cleanly by running <code>bin/shutdown.sh</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># cd /opt/snowowl-community_{version}
# bin/shutdown.sh</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_importing_content_from_a_release_archive">Importing content from a release archive</h3>
<div class="paragraph">
<p>To import a <code>SnomedCT_Release_XXX_xxxxxxxx.zip</code> release archive, the file must be present in the Snow Owl Server host file system, which we will refer to as {import_archive}.</p>
</div>
<div class="sect3">
<h4 id="_starting_the_import">Starting the import</h4>
<div class="paragraph">
<p>Use the following OSGi command to start the import process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; sctimport rf2_release -t &lt;type&gt; -b &lt;branch&gt; -v /path/to/{import_archive} /path/to/{release_descriptor_file}</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">-t &lt;type&gt;</dt>
<dd>
<p>One of <code>FULL</code>, <code>SNAPSHOT</code> or <code>DELTA</code>, depending on the import type the administrator wants to use. The parameter is case-insensitive.</p>
</dd>
<dt class="hdlist1">-b &lt;branch&gt;</dt>
<dd>
<p>The existing branch to import the content onto. In case of extension import, an effective time from the base SNOMED CT release (e.g. 2016-01-31). If omitted <code>MAIN</code> will be used.</p>
</dd>
<dt class="hdlist1">-v</dt>
<dd>
<p>Creates versions for each effective time found in the release archive. If omitted no versions will be created.</p>
</dd>
<dt class="hdlist1">/path/to/{import_archive}</dt>
<dd>
<p>Specifies the release archive to import. Must be a <code>.zip</code> file with a supported internal structure, such as the release archive of the International Release.</p>
</dd>
<dt class="hdlist1">/path/to/{release_descriptor_file}</dt>
<dd>
<p>The path to the release descriptor <code>.json</code> file.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_release_decriptor_file">Release decriptor file</h5>
<div class="paragraph">
<p>The release descriptor <code>.json</code> file could contain the following attributes as key/value pairs:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Name</dt>
<dd>
<p>Descriptive name of the code system.</p>
</dd>
<dt class="hdlist1">Short name</dt>
<dd>
<p>Short name of the code system. Must <strong>not</strong> contain any whitespaces, must be <strong>unique</strong> among the other code systems already present in Snow Owl.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <code>terminologyregistry listall</code> OSGi command to list all existing code systems.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Language</dt>
<dd>
<p>Three letter language code of the code system.</p>
</dd>
<dt class="hdlist1">Code system OID</dt>
<dd>
<p>The OID of the code system.</p>
</dd>
<dt class="hdlist1">Extension of</dt>
<dd>
<p>The short name of the base code system / release this SNOMED CT release depends on.</p>
</dd>
<dt class="hdlist1">Maintaining organization link</dt>
<dd>
<p>Maintaining organization link.</p>
</dd>
<dt class="hdlist1">Release type</dt>
<dd>
<p>The type of the release. Either <code>INTERNATIONAL</code> or <code>EXTENSION</code>.</p>
</dd>
<dt class="hdlist1">Citation</dt>
<dd>
<p>Citation.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_examples">Examples</h4>
<div class="sect4">
<h5 id="_international_import">International import</h5>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; sctimport rf2_release -t FULL /path/to/{international_import_archive} /path/to/snomed_ct_international.json</pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>snomed_ct_international.json</code> looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Systematized Nomenclature of Medicine Clinical Terms International Version</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">shortName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ENG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">codeSystemOID</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2.16.840.1.113883.6.96</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">maintainingOrganizationLink</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.ihtsdo.org</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">citation</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMED CT contributes to the improvement of patient care by underpinning the development of Electronic Health Records that record clinical information in ways that enable meaning-based retrieval. This provides effective access to information required for decision support and consistent reporting and analysis. Patients benefit from the use of SNOMED CT because it improves the recording of EHR information and facilitates better communication, leading to improvements in the quality of care.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_extension_import">Extension import</h5>
<div class="paragraph">
<p>An extension import based on the 2015-01-31 version of the international release:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; sctimport rf2_release -t FULL -b 2015-01-31 -v /path/to/{extension_import_archive} /path/to/snomed_ct_extension.json</pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>snomed_ct_extension.json</code> looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMED CT Special Extension</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">shortName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT-SE</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ENG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">codeSystemOID</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2.16.840.1.113883.6.96.2</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">extensionOf</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">maintainingOrganizationLink</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.snomed-special-extension.org</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">citation</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Long citation about the details of SNOMED CT special extension</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While the import is running, feedback might be delayed on the OSGi console. Log output can be observed throughout the import session in the file <code>serviceability/logs/log.log</code>. The import may take several hours depending on your hardware and JVM configuration.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_single_administrator_operations">Single administrator operations</h3>
<div class="paragraph">
<p>Import and export processes are dedicated single administrator operations. As these operations are long-running, administrators
need to ensure that during these processes no other users should be connected to the system. The following steps describe how to
disconnect all clients from the server and how to ensure that no one else, but the administrator is the only connected user while
performing any import/export operations.</p>
</div>
<div class="sect3">
<h4 id="_list_of_single_administrator_operations">List of single administrator operations</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 12.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Console command</th>
<th class="tableblock halign-left valign-top">Snow Owl UI</th>
<th class="tableblock halign-left valign-top">Admin console</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ATC import from ClaML</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICD-10 import from ClaML</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICD-10-AM import from .zip archive</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Local Code System import from Excel spreadsheet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localcodesystem importXL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOINC import from .zip archive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>loinc import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mapping set import from Excel spreadsheet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mappingset import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNOMED CT release import from RF2 files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sctimport rf2_release</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> (zip only)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNOMED CT reference set import from RF2 file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sctimport rf2_refset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNOMED CT reference set import from delimiter-separated file (includes RF1 subset files)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sctimport dsv_refset</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value domain import from Excel spreadsheet</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value domain import from UMLS SVS XML file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>valueset import</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Import MRCM rules from XMI file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mrcm import</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Export MRCM rules to XMI file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mrcm export</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_list_of_operations_that_can_be_executed_by_regular_users">List of operations that can be executed by regular users</h4>
<div class="ulist">
<ul>
<li>
<p>ATC export to ClaML</p>
</li>
<li>
<p>Local Code System export to Excel spreadsheet</p>
</li>
<li>
<p>Mapping set export to Excel spreadsheet</p>
</li>
<li>
<p>SNOMED CT core components export to OWL 2</p>
</li>
<li>
<p>SNOMED CT reference set export to RF1 and RF2</p>
</li>
<li>
<p>SNOMED CT reference set export to Delimiter-Separated Values text file</p>
</li>
<li>
<p>Value domain export to Excel spreadsheet</p>
</li>
<li>
<p>Value domain export to UMLS SVS XML file</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_to_perform_single_admin_operations">Steps to perform single admin operations</h4>
<div class="paragraph">
<p>Checking the connected users from the OSGi server console, to list all connected users one should perform the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session users
User: info@b2international.com ,session id: 9</pre>
</div>
</div>
<div class="paragraph">
<p>Before starting to gracefully disconnect users, the administrator should disable non-administrator user logins to the server.
To check the login status on the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login status
Non-administrative logins are currently enabled.</pre>
</div>
</div>
<div class="paragraph">
<p>As the response states above, there is no login restrictions applied. To restrict non-administrator logging, one should execute
the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login disabled
Disabled non-administrative logins.</pre>
</div>
</div>
<div class="paragraph">
<p>Now any users with insufficient privileges (in other words; users without 'Administrator' role) will be refused by the server when
trying to connect.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
None of the currently connected users will be disconnected. Connected users have to be disconnected by the administrator via
the OSGi console as described later.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The administrator can send an informational message from the OSGi console to connected clients, so users can be informed about the
upcoming maintenance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session message ALL Server is going down in 10 minutes due to a SNOMED CT publication process. Please commit all your unsaved changes.
Message sent to info@b2international.com</pre>
</div>
</div>
<div class="paragraph">
<p>To disconnect all currently connected users:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session disconnect ALL
User: info@b2international.com ,session id: 9 was disconnected.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this case, all clients, including the administrator will be logged out from the server, but the administrator may reconnect to the
server as only non-administrative users are locked out.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After disabling non-administrator user login, notifying and disconnecting users, double-check of the current status and the connected
users at the server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login status
Non-administrative logins are currently disabled.</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session users
osgi&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>It is now safe to perform any single administrator operations, such as an RF2 import. When finished, enable non-administrative connections again:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login enabled
Enabled non-administrative logins.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_impersonating_users">Impersonating users</h4>
<div class="paragraph">
<p>Snow Owl Server will ask for a user identifier for server-side import operations in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SNOMED CT RF2 import</p>
</li>
<li>
<p>Local code system import from Excel</p>
</li>
<li>
<p>LOINC import from release archive</p>
</li>
<li>
<p>Mapping set import</p>
</li>
<li>
<p>Value domain import</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The user identifier will be used for associating commits to the terminology repository with a user in the commit information view.</p>
</div>
</div>
<div class="sect3">
<h4 id="_taking_backups">Taking backups</h4>
<div class="sect4">
<h5 id="__hot_backups">"Hot" backups</h5>
<div class="paragraph">
<p>The example shell script <code>snowowl_hot_backup_mysql.sh</code> exercises all functionality mentioned above, and produces a .zip
archive containing database dumps and copies of index folders in the directory it is started from. Please update the variable
<code>SNOW_OWL_SERVER_HOME</code> so that it points to the installation folder of Snow Owl Server before running the script.</p>
</div>
<div class="paragraph">
<p>The return value is 0 for successful backups, and 1 if an error occurs while backing up content from the server. The script
produces timestamped diagnostic output on its standard output; error messages are directed to the standard error output.</p>
</div>
<div class="paragraph">
<p>To create backups regularly, add a dedicated non-login user for backups as root:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># useradd -r -M -d / -s /sbin/nologin -c "Snow Owl Backup" snowowl-backup</pre>
</div>
</div>
<div class="paragraph">
<p>Create and/or update access privileges of the backup destination, log output, and the location of the singleton instance lock file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># mkdir -pv /storage/backups /var/log/snowowl-backup /var/run/snowowl-backup
mkdir: created directory `/storage/backups'
mkdir: created directory `/var/log/snowowl-backup'
mkdir: created directory `/var/run/snowowl-backup'

# chown -v root:snowowl-backup /storage/backups /var/log/snowowl-backup /var/run/snowowl-backup
changed ownership of `/storage/backups' to root:snowowl-backup
changed ownership of `/var/log/snowowl-backup' to root:snowowl-backup
changed ownership of `/var/run/snowowl-backup' to root:snowowl-backup

# chmod -v 775 /storage/backups /var/log/snowowl-backup /var/run/snowowl-backup
mode of `/storage/backups' changed to 0775 (rwxrwxr-x)
mode of `/var/log/snowowl-backup' changed to 0775 (rwxrwxr-x)
mode of `/var/run/snowowl-backup' changed to 0775 (rwxrwxr-x)</pre>
</div>
</div>
<div class="paragraph">
<p>Save the backup script in an accessible place, set the owner to snowowl-backup, and make it executable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre># chown -v snowowl-backup: /storage/backups/snowowl_full_backup_mysql.sh
changed ownership of `/storage/backups/snowowl_full_backup_mysql.sh' to snowowl-backup:snowowl-backup

# chmod -v 744 /storage/backups/snowowl_full_backup_mysql.sh
mode of `/storage/backups/snowowl_full_backup_mysql.sh' changed to 0744 (rwxr--r--)</pre>
</div>
</div>
<div class="paragraph">
<p>Add the script to the backup user&#8217;s crontab (the example runs the script at 4 AM, and outputs log entries to logfiles
with a year-month-date suffix in /var/log/snowowl-backup):</p>
</div>
<div class="listingblock">
<div class="content">
<pre># EDITOR=nano crontab -e -u snowowl-backups

&lt;nano opens; add the content below to the opened file, save, and exit the editor&gt;

# MAILTO="local-user"
#
# Minute - Hour - Day of month - Month - Day of week - Command
0 4 * * * cd /storage/backups &amp;&amp; ( ./snowowl_full_backup_mysql.sh &gt;&gt; /var/log/snowowl-backup/log-`date +\%Y\%m\%d` 2&gt;&amp;1 )</pre>
</div>
</div>
<div class="paragraph">
<p>(If the standard error output is not redirected with the "2&gt;&amp;1" part of the command, errors will be captured by cron
and mailed to the snowowl-backup user&#8217;s mailbox. The destination can be changed by uncommenting the MAILTO parameter
and setting it to a different address.)</p>
</div>
</div>
<div class="sect4">
<h5 id="__cold_backups">"Cold" backups</h5>
<div class="paragraph">
<p>When the server is shut down, the above mentioned REST service for enumerating store content and getting exclusive
write locks for the repositories is not available, so a separate script, <code>snowowl_cold_backup_mysql.sh</code> is being provided for this case.</p>
</div>
</div>
<div class="sect4">
<h5 id="_backing_up_and_restoring_data_in_the_issue_tracker">Backing up and restoring data in the issue tracker</h5>
<div class="paragraph">
<p>A detailed list of steps are available at the Move Installation page of Mozilla Wiki (which describes moving the installation from
one machine to another, but can also be applied for backup and restore on the same server). The important parts to take note of
are the commands used for dumping the SQL database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mysqldump -u(username) -p(password) bugs &gt; bugzilla-backup.sql</pre>
</div>
</div>
<div class="paragraph">
<p>Reloading the SQL dump later requires the database to be cleared and recreated from the MySQL console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mysql&gt; DROP DATABASE bugs;
mysql&gt; CREATE DATABASE bugs DEFAULT CHARSET utf8;</pre>
</div>
</div>
<div class="paragraph">
<p>Applying the dump goes as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mysql -u (username) -p(password) bugs &lt; /path/to/bugzilla-backup.sql</pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the contents of the database, the <code>data</code> directory and the <code>localconfig</code> file from Bugzilla&#8217;s
installation directory should also be preserved.
= Console command reference</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_introduction_5">Introduction</h3>
<div class="paragraph">
<p>This documents lists commands available to the system administrator when connecting to the OSGi console of a running
Snow Owl Server instance using telnet or SSH. Instructions for setting up the console can be found in the section
titled &#8220;OSGi console&#8221; of the Configuration guide.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Depending on log configuration, the output shown following user-entered commands in the usage examples might only
appear in the service log, located at <code>serviceability/logs/log.log</code> in the Snow Owl Server installation folder, or the
export/import logs in folder <code>serviceability/logs/snowowl</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_general_2">General</h3>
<div class="sect3">
<h4 id="_getting_help">Getting help</h4>
<div class="paragraph">
<p>To get a quick overview of all available commands, type <code>help</code> into the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; help
---CDO commands---
       cdo list - list all active repositories
       cdo start - start repositories from a config file
       cdo stop - stop a repository
...
service - list all services in the service registry
  scope: vsh
  parameters:
     String   operation (list)

service - examine a service in the service registry
  scope: vsh
  parameters:
     String   operation (examine)
     long     service id

shutdown - shut down the kernel
  scope: vsh</pre>
</div>
</div>
<div class="paragraph">
<p>The displayed list of commands are a mixture of application-specific and framework-specific operations; the following
categories provide functionality related to the terminology server itself:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Local code system datastore commands&#8201;&#8212;&#8201;<code>localcodesystem</code></p>
</li>
<li>
<p>LOINC datastore commands&#8201;&#8212;&#8201;<code>loinc</code></p>
</li>
<li>
<p>Mapping Set datastore commands&#8201;&#8212;&#8201;<code>mappingset</code></p>
</li>
<li>
<p>Scripting Commands&#8201;&#8212;&#8201;<code>script</code></p>
</li>
<li>
<p>MRCM commands&#8201;&#8212;&#8201;<code>mrcm</code></p>
</li>
<li>
<p>Terminology registry commands&#8201;&#8212;&#8201;<code>terminologyregistry</code></p>
</li>
<li>
<p>SNOMED CT OWL ontology commands&#8201;&#8212;&#8201;<code>ontology</code></p>
</li>
<li>
<p>SNOMED CT importer commands&#8201;&#8212;&#8201;<code>sctimport</code></p>
</li>
<li>
<p>Value Domain datastore commands&#8201;&#8212;&#8201;<code>valueset</code></p>
</li>
<li>
<p>Diagnostic and maintenance commands&#8201;&#8212;&#8201;<code>snowowl</code></p>
</li>
<li>
<p>Session management commands&#8201;&#8212;&#8201;<code>session</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To narrow the command list down to a certain category, type the category name given above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; localcodesystem
--- Local code system datastore commands ---
       localcodesystem exportXL local_codesystems_excelfile_path - Exports local code...
       localcodesystem importXL local_codesystems_excelfile_path clear_database - ...</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disconnecting_from_the_console">Disconnecting from the console</h4>
<div class="paragraph">
<p>To leave the console (and keep the server running), type <code>disconnect</code>, then confirm the operation by pressing Enter.
Alternatively, you can type "y" to confirm, or "n" to back out.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; disconnect
Disconnect from console? (y/n; default=y) y

Connection closed by foreign host.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_local_code_systems">Local code systems</h3>
<div class="sect3">
<h4 id="_import_local_code_systems_from_a_spreadsheet">Import local code systems from a spreadsheet</h4>
<div class="paragraph">
<p><code>localcodesystem importXL</code> imports local code system content from the specified Excel spreadsheet (with <code>.xls</code> or
<code>.xlsx</code> extension). Required arguments are the spreadsheet path and the merge mode, expressed as an integer with three
possible values:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic" start="0">
<li>
<p>&#8220;clear&#8221;&#8201;&#8212;&#8201;all existing local terminology entries are removed from the terminology store first, then the contents
of the spreadsheet are added;</p>
</li>
<li>
<p>&#8220;merge&#8221;&#8201;&#8212;&#8201;if the terminology store already contains a local terminology to be imported, metadata groups and local
codes with the same identifiers will be unaffected, while new incoming elements (ex.: local codes, metadata keywords)
are going to be added to the existing local terminology</p>
</li>
<li>
<p>&#8220;replace&#8221;&#8201;&#8212;&#8201;similar to merge, but when an existing local terminology is encountered, the existing content will
be replaced by the spreadsheet&#8217;s related content.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The administrator is also required to provide a user identifier; the given user ID will be displayed in the commit log
as the importing user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; localcodesystem importXL /path/to/local_code_systems.xlsx 0
Impersonate operation as: info@b2international.com

... - Importing local code systems from excel file: /path/to/local_code_systems.xlsx
...
... - Clearing index data...
... - Clearing index data successfully finished.
... - Converted local code system ABCD with 9 codes.
...
... - Updating terminology metadata.
...</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_export_local_code_systems_to_a_spreadsheet">Export local code systems to a spreadsheet</h4>
<div class="paragraph">
<p><code>localcodesystem exportXL</code> will generate an Excel file in XLSX format, in which all local terminology metadata and
codes will be presented on different worksheets. The only required argument is a destination path; the exported file
will be added to this location on the server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; localcodesystem exportXL /path/to/exported_spreadsheet.xlsx

... - Exporting Local Code Systems to Excel started. Server-side file: /path/to/exported_spreadsheet.xlsx
...
... - Finished exporting Local Code Systems to Excel.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loinc">LOINC</h3>
<div class="sect3">
<h4 id="_import_loinc_vocabulary_from_a_release_archive">Import LOINC vocabulary from a release archive</h4>
<div class="paragraph">
<p><code>loinc import</code> replaces existing LOINC terminology store content with the concepts and multi-axial hierarchy given
in the specified input <code>.zip</code> archive. This command also requires a user identifier to be entered, which will be
presented as the importing user in the commit information view.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; loinc import /path/to/loinc_archive.zip
Impersonate operation as: info@b2international.com

... - LOINC import: 0%
... - Processed LOINC multi-axial hieararchy lines: 0
... - Processed LOINC multi-axial hieararchy lines: 10000
... - LOINC import: 1%
...
... - Set children for number of beans: 1000
... - Set children for number of beans: 2000
... - LOINC import: 10%
... - Set children for number of beans: 3000
...
... - Processed and normalized the LOINC hierarchy file: 76675 entries.
... - Processed LOINC table rows: 10000
... - LOINC import: 16%
... - Processed LOINC table rows: 20000
...
... - Processed the LOINC table file: 71464 lines.
... - Processed 10000 skeleton components.
...
... - Processed the total of 76675 skeleton components.
...
... - Processed 50000 concepts with hierarchy info.
...
... - Processed 76675 concepts with hierarchy info.
... - Commit notification received for user info@b2international.com.
... - Clearing index data...
... - Clearing index data successfully finished.
...
... - LOINC import: 96%
... - Processed 40000 index entries.
... - LOINC import: 97%
...
... - LOINC import: 100%
... - LOINC import completed.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mapping_sets">Mapping sets</h3>
<div class="sect3">
<h4 id="_import_mapping_sets_from_a_spreadsheet">Import mapping sets from a spreadsheet</h4>
<div class="paragraph">
<p><code>mappingset import</code> allows the administrator to import one or more mapping sets from the specified spreadsheet; the
command also requires a merge setting (given as an integer). The selection and meaning of merge options are the same
as the ones given in <a href="#_import_local_code_systems_from_a_spreadsheet">Import local code systems from a spreadsheet</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; mappingset import /path/to/mapping_sets.xlsx 1
Impersonate operation as: info@b2international.com

... - Importing mapping sets from excel file: /path/to/mapping_sets.xlsx
... - Processed excel sheet 1. First spreadsheet for mapping set
... - Branch: MAIN Event: MappingSet:  new components added: 12
... - Commit notification received for user info@b2international.com.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scripting">Scripting</h3>
<div class="sect3">
<h4 id="_execute_groovy_script">Execute Groovy script</h4>
<div class="paragraph">
<p><code>script run</code> parses and executes the specified Groovy script. Services will be provided by the running server instance,
similarly to the Groovy editing environment within the Snow Owl client.</p>
</div>
<div class="paragraph">
<p>Make sure to inspect the server log for any issues, as they might not be printed to the console output depending on the
log configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; script run /home/user/IndexExample.groovy

[Systemic blood pressure]
Number of results for 'hyp' query term: 3566
[Hypertensive disorder, Hyperlipidaemia, Asthma]
Number of results for 'hyp' AND 'blood cell' query term: 100
Autologous peripheral blood stem cell transplant
White blood cell disorder
...
Red blood cell count, manual, peritoneal fluid
Red blood cell folate borderline high
ID          Label
425983008   Autologous peripheral blood stem cell transplant
54097007    White blood cell disorder
...
442218004   Red blood cell folate borderline high</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_machine_readable_concept_model">Machine-Readable Concept Model</h3>
<div class="sect3">
<h4 id="_import_mrcm_rules_from_xmi_file">Import MRCM rules from XMI file</h4>
<div class="paragraph">
<p><code>mrcm import</code> reads and applies rules from the specified source file. Note that as with regular editing of MRCM rules,
only SNOMED CT concept and reference set editors opened after the import will display their output with the changes
considered.</p>
</div>
<div class="paragraph">
<p>This command also requires the specification of a user identifier, which will be presented as the importing user in
the commit information view.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; mrcm import /path/to/mrcm_20131212143528517.xmi
Impersonate operation as: info@b2international.com

... - Importing MRCM rules...
...
... - Persisting changes...
... - Changes have been successfully persisted.
... - Branch: MAIN Event: SNOMED CT Changes: changed concepts: [123037004:Body structure], ...
...
... - MRCM rule import successfully finished.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_export_mrcm_rules_to_an_xmi_file">Export MRCM rules to an XMI file</h4>
<div class="paragraph">
<p><code>mrcm export</code> creates a file named <code>mrcm_{timestamp}.xmi</code> in the directory given by the administrator. The command
requires a user identifier which will be recorded in the user audit log.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; mrcm export /path/to/export/folder
Impersonate operation as: info@b2international.com

... - Exporting MRCM rules...
...
... - MRCM rule export successfully finished.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_terminology_registry">Terminology registry</h3>
<div class="sect3">
<h4 id="_list_all_imported_terminologies">List all imported terminologies</h4>
<div class="paragraph">
<p><code>terminologyregistry listall</code> displays information about terminologies and terminology extensions imported into the running server instance,
including individual local code systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; terminologyregistry listall

Name: ABC Local Test Dictionary short name: ABCD OID: 9.8.7.6.54321 organization: http://localhost/abcd language: ENG last version: 0.1
Name: International Classification of Diseases short name: ICD-10 OID: 2.16.840.1.113883.6.3 organization: http://www.who.int/classifications/icd/en/ language: ENG last version: 1
Name: Logical Observation Identifiers Names and Codes short name: LOINC OID: 2.16.840.1.113883.6.1 organization: http://loinc.org language: ENG last version: 2
Name: Anatomical Therapeutic Chemical Classification System short name: ATC OID: 2.16.840.1.113883.6.73 organization: http://www.who.int/classifications/atcddd/en/ language: ENG last version: 1
Name: Australian Modification of the International Classification of Diseases short name: ICD-10-AM OID: 2.16.840.1.113883.6.135 organization: http://sydney.edu.au/health-sciences/ncch/about.shtml language: ENG last version: 1
Name: Systematized Nomenclature of Medicine Clinical Terms International Version short name: SNOMEDCT OID: 2.16.840.1.113883.6.96 organization: http://www.ihtsdo.org language: ENG last version: 2013-07-31</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snomed_ct_owl_ontology_reasoner">SNOMED CT OWL ontology (reasoner)</h3>
<div class="sect3">
<h4 id="_display_available_reasoners">Display available reasoners</h4>
<div class="paragraph">
<p>To list the available reasoners and the preferred one (marked with an <code>*</code> symbol) one has to perform the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; ontology list

   0 None [version: 4.1.0] (org.protege.editor.owl.NoOpReasoner)
   1 ELK 0.3.2 [version: 0.3.2] (org.semanticweb.elk.elk.reasoner.factory)
 * 2 MORe A (0.1.3) [version: 0.1.3] (org.semanticweb.more.MORe.reasoner.factory)
   3 MORe B (0.1.3) [version: 0.1.3] (org.semanticweb.more.MOReRLrew.reasoner.factory)
   4 FaCT++ [version: 1.6.2] (uk.ac.manchester.cs.owl.factplusplus.factplusplus-factory)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_change_the_active_reasoner">Change the active reasoner</h4>
<div class="paragraph">
<p>To change the preferred reasoner on the server (in our case from <code>MORe A</code> to <code>FaCT++</code>), use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; ontology select 4

   0 None [version: 4.1.0] (org.protege.editor.owl.NoOpReasoner)
   1 ELK 0.3.2 [version: 0.3.2] (org.semanticweb.elk.elk.reasoner.factory)
   2 MORe A (0.1.3) [version: 0.1.3] (org.semanticweb.more.MORe.reasoner.factory)
   3 MORe B (0.1.3) [version: 0.1.3] (org.semanticweb.more.MOReRLrew.reasoner.factory)
 * 4 FaCT++ [version: 1.6.2] (uk.ac.manchester.cs.owl.factplusplus.factplusplus-factory)</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this setting does not affect ongoing computations if they were started using a different reasoner.</p>
</div>
</div>
<div class="sect3">
<h4 id="_checking_status_of_available_reasoners">Checking status of available reasoners</h4>
<div class="paragraph">
<p>The command checks the presence and availability of all reasoners available on the server side. In case of the
response below, all reasoners are available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; ontology check
All reasoner instances are available and ready for use.</pre>
</div>
</div>
<div class="paragraph">
<p>Whenever any of the reasoners is not available, the output should contain the problematic reasoner identifier.
Please note that reasoner identifiers may vary; also, if more than one reasoner reports a problem, a list of
reasoner identifiers will be printed to the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; ontology check
Couldn't initialize reasoner factory for ID 'unique.id.of.the.reasoner'.</pre>
</div>
</div>
<div class="paragraph">
<p>For getting the original cause of the reasoner availability issue, one could dump the exception by appending
the <code>-d</code> flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; ontology check -d
Couldn't initialize reasoner factory for ID 'unique.id.of.the.reasoner'.

com.b2international.snowowl.snomed.reasoner.exceptions.ReasonerException: Couldn't initialize reasoner factory for ID 'unique.id.of.the.reasoner'.
    at com.b2international.snowowl.snomed.reasoner.server.preferences.ReasonerPreferencesService.createReasonerInfo(ReasonerPreferencesService.java:306)
    at com.b2international.snowowl.snomed.reasoner.server.preferences.ReasonerPreferencesService.checkAllAvailableReasoners(ReasonerPreferencesService.java:270)
    at com.b2international.snowowl.snomed.reasoner.server.console.SnomedOntologyCommandProvider$Command$3.execute(SnomedOntologyCommandProvider.java:65)
    at com.b2international.snowowl.snomed.reasoner.server.console.SnomedOntologyCommandProvider._ontology(SnomedOntologyCommandProvider.java:150)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.eclipse.osgi.framework.internal.core.FrameworkCommandInterpreter.execute(FrameworkCommandInterpreter.java:209)
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snomed_ct_2">SNOMED CT</h3>
<div class="sect3">
<h4 id="_import_reference_sets_in_rf2_format_from_a_release_text_file">Import reference sets in RF2 format from a release text file</h4>
<div class="paragraph">
<p>Use <code>sctimport rf2_refset</code> to import one or more reference sets from an RF2 text file. All RF2 import modes (<code>FULL</code>,
<code>SNAPSHOT</code> and <code>DELTA</code>) are available; certain reference set members can be excluded from being imported based on
their reference set identifiers.</p>
</div>
<div class="paragraph">
<p>The following example imports a snapshot release file from the SNOMED CT International RF2 release, excluding two
reference sets by identifier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; sctimport rf2_refset /path/to/der2_Refset_SimpleSnapshot_INT_20130731.txt -t SNAPSHOT -x 447566000 447565001

[2013-12-12 17:10:47.987] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - SNOMED CT import started from RF2 release format.
[2013-12-12 17:10:47.987] User: web Event: SNOMED CT import started from RF2 release format.
Importing release files...: 0% [0ms]
[2013-12-12 17:10:47.988] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Validating release files...
[2013-12-12 17:10:47.988] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Validating RF2 release files.
[2013-12-12 17:10:47.988] User: web Event: Validating RF2 release files.
[2013-12-12 17:10:47.988] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Creating staging directory '...' for simple type reference set member validation.
Preparing simple type reference set members validation: 5% [96ms]
[2013-12-12 17:10:48.083] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Validating 'der2_Refset_SimpleSnapshot_INT_20130731.txt' release file.
[2013-12-12 17:10:48.083] User: web Event: Validating 'der2_Refset_SimpleSnapshot_INT_20130731.txt' release file.
Validating simple type reference set members...: 11% [868ms]
[2013-12-12 17:10:48.954] [OSGi Console] INFO  c.b.commons.db.JdbcUtils - Connected to database '...'.
Finishing simple type reference set members validation: 17% [3ms]
[2013-12-12 17:10:48.954] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Preparing simple type reference set member import
[2013-12-12 17:10:48.954] User: web Event: Preparing simple type reference set member import
[2013-12-12 17:10:48.954] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Creating staging directory '...' for simple type reference set member import.
[2013-12-12 17:10:48.954] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Creating staging directory '...' for simple type reference set member import.
[2013-12-12 17:10:48.954] User: web Event: Creating staging directory '...' for simple type reference set member import.
Preparing simple type reference set member import: 20% [1ms]
[2013-12-12 17:10:48.955] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Populating storage keys for simple type reference set member import.
[2013-12-12 17:10:48.955] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Populating storage keys for simple type reference set member import.
[2013-12-12 17:10:48.955] User: web Event: Populating storage keys for simple type reference set member import.
Preparing simple type reference set member import: 21% [2ms]
Preparing simple type reference set member import: 22% [595ms]
Preparing simple type reference set member import: 23% [8382ms]
[2013-12-12 17:10:58.002] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Collecting simple type reference set member import units
[2013-12-12 17:10:58.002] User: web Event: Collecting simple type reference set member import units
Collecting simple type reference set member import units: 24% [92ms]
...
[2013-12-12 17:10:58.148] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Processing simple type reference set members
[2013-12-12 17:10:58.148] User: web Event: Processing simple type reference set members
...
Processing simple type reference set members: 88% [17ms]
[2013-12-12 17:10:59.325] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Finishing simple type reference set member import
[2013-12-12 17:10:59.325] User: web Event: Finishing simple type reference set member import
[2013-12-12 17:10:59.325] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Creating indexes for simple type reference set member import.
[2013-12-12 17:10:59.325] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Creating indexes for simple type reference set member import.
[2013-12-12 17:10:59.325] User: web Event: Creating indexes for simple type reference set member import.
[2013-12-12 17:10:59.334] [OSGi Console] WARN  c.b.s.s.i.rf2.util.ImportUtil - Couldn't create or drop index SNOMEDREFSET_SNOMEDREFSETMEMBER_IDX1000 for table SNOMEDREFSET_SNOMEDREFSETMEMBER.
[2013-12-12 17:10:59.334] [OSGi Console] WARN  c.b.s.s.i.rf2.util.ImportUtil - Couldn't create or drop index SNOMEDREFSET_SNOMEDREFSETMEMBER_IDX1001 for table SNOMEDREFSET_SNOMEDREFSETMEMBER.
Finishing simple type reference set member import: 89% [10ms]
[2013-12-12 17:10:59.335] [OSGi Console] WARN  c.b.s.s.i.rf2.util.ImportUtil - Couldn't create or drop index SNOMEDREFSET_SNOMEDREFSETMEMBER_IDX1002 for table SNOMEDREFSET_SNOMEDREFSETMEMBER.
Finishing simple type reference set member import: 90% [1ms]
[2013-12-12 17:10:59.336] [OSGi Console] WARN  c.b.s.s.i.rf2.util.ImportUtil - Couldn't create or drop index SNOMEDREFSET_SNOMEDREFSETMEMBER_IDX1003 for table SNOMEDREFSET_SNOMEDREFSETMEMBER.
Finishing simple type reference set member import: 91% [1ms]
[2013-12-12 17:10:59.336] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - Removing staging directory '...' from simple type reference set member import.
[2013-12-12 17:10:59.336] [OSGi Console] INFO  c.b.s.s.i.r.m.AbstractSnomedImporter - Removing staging directory '...' from simple type reference set member import.
[2013-12-12 17:10:59.336] User: web Event: Removing staging directory '...' from simple type reference set member import.
Finishing simple type reference set member import: 94% [1ms]
Finishing simple type reference set member import: 100% [0ms]
[2013-12-12 17:10:59.337] [OSGi Console] INFO  c.b.s.s.i.rf2.util.ImportUtil - SNOMED CT import successfully finished.
[2013-12-12 17:10:59.337] User: web Event: SNOMED CT import successfully finished.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that messages related to not being able to create or drop database indexes are not an indication of a failed import process.</p>
</div>
</div>
<div class="sect3">
<h4 id="_import_reference_sets_in_dsv_format">Import reference sets in DSV format</h4>
<div class="paragraph">
<p><code>sctimport dsv_refset</code> imports a single reference set from text files in Delimiter Separated Values (DSV) format. The syntax is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sctimport dsv_refset &lt;path&gt; &lt;hasHeader&gt; &lt;skipEmptyLines&gt; &lt;parentConcept&gt;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">&lt;path&gt;</dt>
<dd>
<p>Specifies the file to be used for importing</p>
</dd>
<dt class="hdlist1">&lt;hasHeader&gt;</dt>
<dd>
<p>Set to <code>true</code> if the source text file has a header row, <code>false</code> otherwise</p>
</dd>
<dt class="hdlist1">&lt;skipEmptyLines&gt;</dt>
<dd>
<p>Set to <code>true</code> if the source text file has empty lines which should be ignored, <code>false</code> otherwise</p>
</dd>
<dt class="hdlist1">&lt;parentConcept&gt;</dt>
<dd>
<p>Set to an integer value specifying the parent of the imported reference set&#8217;s identifier concept</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Accepted values for parentConcept are:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="olist arabic">
<ol class="arabic" start="0">
<li>
<p>Simple type</p>
</li>
<li>
<p>B2i examples</p>
</li>
<li>
<p>KP Convergent Medical Terminology</p>
</li>
<li>
<p>CORE Problem List</p>
</li>
<li>
<p>Infoway Primary Health Care</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>The reference set name is determined by the input file name; as an example, <code>CamelCase.csv</code> will be converted to
<code>Camel Case reference set</code>. An attempt will be made to interpret the first column of each line as a SNOMED CT
concept identifier. If the identifier can be resolved, a member will be added to the reference set, otherwise
an exception is thrown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; sctimport dsv_refset /path/to/SampleConcepts.txt false true 0
Impersonate operation as: info@b2international.com

Importing Interesting Reference Set...
[2013-12-12 17:22:03.154] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() start
[2013-12-12 17:22:03.154] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() lock acquired for BranchPath{Path='MAIN'}
[2013-12-12 17:22:03.155] [Worker-36] INFO  c.b.s.s.r.s.c.SnomedReasonerChangeProcessor - &gt;&gt;&gt; Processing OWL ontology changes
[2013-12-12 17:22:03.155] [Worker-36] INFO  c.b.s.s.r.s.c.SnomedReasonerChangeProcessor - --- Processing OWL ontology changes: change processing skipped, no ontology instance present for branch or running in embedded mode
[2013-12-12 17:22:03.156] [Worker-36] INFO  c.b.s.s.r.s.c.SnomedReasonerChangeProcessor - &lt;&lt;&lt; Processing OWL ontology changes [249.6 s]
[2013-12-12 17:22:03.156] [Worker-43] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Processing and updating changes...
[2013-12-12 17:22:03.156] [Worker-43] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Retrieving taxonomic information from store.
[2013-12-12 17:22:03.313] [Worker-42] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Processing changes taxonomic information.
[2013-12-12 17:22:03.313] [Worker-34] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Building taxonomic information.
[2013-12-12 17:22:03.315] [Worker-42] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Rebuilding taxonomic information based on the changes.
[2013-12-12 17:22:03.573] [Taxonomy difference processor] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Calculating taxonomic differences...
[2013-12-12 17:22:03.586] [Worker-43] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Updating reference set membership changes...
[2013-12-12 17:22:03.586] [Worker-43] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Updating taxonomy...
[2013-12-12 17:22:03.602] [Taxonomy difference processor] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Calculating taxonomic differences successfully finished.
[2013-12-12 17:22:03.602] [Worker-43] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Processing and updating changes successfully finished.
[2013-12-12 17:22:03.602] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() end
[2013-12-12 17:22:03.628] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() start
[2013-12-12 17:22:03.628] [Worker-36] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Persisting changes...
[2013-12-12 17:22:03.689] [Worker-36] INFO  c.b.s.d.s.s.i.SnomedCDOChangeProcessor - Changes have been successfully persisted.
[2013-12-12 17:22:03.689] User: info@b2international.com Branch: MAIN Event: SNOMED CT Changes: new concepts added: [745288891000154109:Sample Concepts reference set], changed concepts: [446609009:Simple type reference set], new reference sets: [745288891000154109:Sample Concepts reference set],
[2013-12-12 17:22:03.690] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() end
[2013-12-12 17:22:03.690] [OSGi Console] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() lock released for BranchPath{Path='MAIN'}
[2013-12-12 17:22:03.769] [OSGi Console] INFO  c.b.s.d.PostStoreUpdateManager - Commit notification received for user info@b2international.com.
All concepts were imported.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_value_domain">Value Domain</h3>
<div class="sect3">
<h4 id="_import_value_domains_from_a_umls_svs_xml_file">Import value domains from a UMLS SVS XML file</h4>
<div class="paragraph">
<p><code>valueset import</code> works with value domain terminology content and also supports the three merge modes mentioned at
the local code system import command. The administrator will be prompted for an importing user identifier, which is
required for identification in the commit information view.</p>
</div>
<div class="paragraph">
<p>The two required arguments are the absolute path of the source XML file, and the selected merge mode (represented
by an integer in the range of 0..2).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; valueset import /path/to/svs_import_file.xml 0
Impersonate operation as: info@b2international.com

[2013-12-12 16:50:04.660] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Importing value domains from UMLS file /path/to/svs_import_file.xml.
[2013-12-12 16:50:04.660] User: info@b2international.com Event: Importing value domains from UMLS file /path/to/svs_import_file.xml.
[2013-12-12 16:50:04.660] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Deleting existing value domains from database...
[2013-12-12 16:50:04.660] User: info@b2international.com Event: Deleting existing value domains from database...
[2013-12-12 16:50:04.755] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() start
[2013-12-12 16:50:04.755] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() lock acquired for BranchPath{Path='MAIN'}
[2013-12-12 16:50:04.776] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() end
[2013-12-12 16:50:04.785] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() start
[2013-12-12 16:50:04.787] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() end
[2013-12-12 16:50:04.787] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() lock released for BranchPath{Path='MAIN'}
[2013-12-12 16:50:04.956] [Worker-11] INFO  c.b.s.d.PostStoreUpdateManager - Commit notification received for user info@b2international.com.
[2013-12-12 16:50:05.083] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Processed value domain Hospital Measures-Joint Commission Mental Disorders.
[2013-12-12 16:50:05.083] User: info@b2international.com Event: Processed value domain Hospital Measures-Joint Commission Mental Disorders.
[2013-12-12 16:50:05.141] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Processed value domain Hospital Measures-Comfort Measures Only Intervention.
[2013-12-12 16:50:05.141] User: info@b2international.com Event: Processed value domain Hospital Measures-Comfort Measures Only Intervention.
...
[2013-12-12 16:50:15.075] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Processed value domain Ethnicity.
[2013-12-12 16:50:15.075] User: info@b2international.com Event: Processed value domain Ethnicity.
[2013-12-12 16:50:17.352] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() start
[2013-12-12 16:50:17.352] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() lock acquired for BranchPath{Path='MAIN'}
[2013-12-12 16:50:28.973] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionBeforeCommitting() end
[2013-12-12 16:50:39.420] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() start
[2013-12-12 16:50:40.085] User: info@b2international.com Branch: MAIN Event: ValueSetFolder:  new components added: 131646
[2013-12-12 16:50:40.086] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() end
[2013-12-12 16:50:40.086] [Worker-11] INFO  c.b.s.d.s.CDOServerChangeManager - handleTransactionAfterCommitted() lock released for BranchPath{Path='MAIN'}
[2013-12-12 16:50:40.965] [Worker-11] INFO  c.b.s.d.PostStoreUpdateManager - Commit notification received for user info@b2international.com.
[2013-12-12 16:50:41.005] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Commited value domains.
[2013-12-12 16:50:41.005] User: info@b2international.com Event: Commited value domains.
[2013-12-12 16:50:41.009] [Worker-11] INFO  c.b.s.v.d.s.i.ValueSetIndexInitializerJob - Clearing indexes for value domain import...
[2013-12-12 16:50:41.009] User: web Event: Clearing indexes for value domain import...
[2013-12-12 16:50:41.020] [Worker-11] INFO  c.b.s.v.d.s.i.ValueSetIndexInitializerJob - Cleared indexes for value domain import
[2013-12-12 16:50:41.020] User: web Event: Cleared indexes for value domain import
[2013-12-12 16:50:41.023] [Worker-11] INFO  c.b.s.v.d.s.i.ValueSetIndexInitializerJob - Processed 2 value domain member index entries.
[2013-12-12 16:50:41.023] User: web Event: Processed 2 value domain member index entries.
...
[2013-12-12 16:50:56.176] [Worker-11] INFO  c.b.s.v.d.s.i.ValueSetIndexInitializerJob - Processed 20 index entries for folders.
[2013-12-12 16:50:56.176] User: web Event: Processed 20 index entries for folders.
[2013-12-12 16:50:58.125] [Worker-11] INFO  c.b.s.d.s.i.AbstractTerminologyImportJob - Completed importing value domains from UMLS file /path/to/svs_import_file.xml.
[2013-12-12 16:50:58.125] User: info@b2international.com Event: Completed importing value domains from UMLS file /path/to/svs_import_file.xml.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_diagnostics_and_maintenance">Diagnostics and maintenance</h3>
<div class="paragraph">
<p><code>snowowl listrepositories</code> prints all the repositories in the system.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>osgi&gt; snowowl listrepositories
Repositories:
	snomedStore</pre>
</div>
</div>
<div class="paragraph">
<p><code>snowowl listbranches [repository]</code> prints all the branches in the system for a repository.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>osgi&gt; snowowl listbranches snomedStore
Branches for repository snomedStore:
|---MAIN
    |---2011-10-01
    |---2012-01-31
    |---2012-07-31
    |---2013-01-31
    |---2013-07-31
    |---2014-01-31
    |---2014-07-31
    |---2015-01-31
        |---SNOMED-CT-SE
            |---2012-12-21
            |---2013-05-31
            |---2013-11-30
            |---2014-05-31
            |---2014-11-30
            |---2015-05-31
    |---2015-07-31
    |---2016-01-31
        |---SNOMED-CT-SE</pre>
</div>
</div>
<div class="paragraph">
<p><code>snowowl dbcreateindex [nsUri]</code> creates the CDO_CREATED index on the proper DB tables for all classes contained by a package identified by its unique namspace URI.</p>
</div>
<div class="paragraph">
<p><code>snowowl reindex [repositoryId]</code> recreates the entire index for the content of the given repository.  This long-running process requires the the server to be shut-down, the index to be deleted manually and a restart before invoking this command.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>osgi&gt;snowowl reindex snomedStore</pre>
</div>
</div>
<div class="paragraph">
<p><code>snowowl optimize [repositoryId] [maxSegments]</code> optimizes the underlying index for the repository to have the supplied maximum number of segments (default number is 1).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>osgi&gt;snowowl optimize snomedStore 6</pre>
</div>
</div>
<div class="paragraph">
<p><code>snowowl purge &lt;repositoryId&gt; &lt;branchPath&gt; &lt;purgeStrategy&gt;</code> optimizes the underlying index by deleting unnecessary documents from the given branch using the given purge strategy (default strategy is LATEST, available strategies are ALL, LATEST, HISTORY)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>osgi&gt;snowowl purge snomedStore MAIN/2016-01-31 ALL</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_session_management">Session management</h3>
<div class="sect3">
<h4 id="_display_connected_users_and_session_identifiers">Display connected users and session identifiers</h4>
<div class="paragraph">
<p>To list all connected users (and the unique session ID), run the following OSGi command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session users

User: akitta@b2international.com | session ID: 3
User: obali@b2international.com | session ID: 4
User: zstorok@b2international.com | session ID: 5
User: apeteri@b2international.com | session ID: 6</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_send_message_to_users">Send message to users</h4>
<div class="paragraph">
<p>To send message to all connected users, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session message ALL Some message from the administrator.

Message sent to akitta@b2international.com
Message sent to obali@b2international.com
Message sent to zstorok@b2international.com
Message sent to apeteri@b2international.com</pre>
</div>
</div>
<div class="paragraph">
<p>All connected client will receive the message via a dialog.</p>
</div>
<div class="paragraph">
<p>For sending message to a subset of recipient users, execute the following OSGi command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session message obali@b2international.com,zstorok@b2international.com Message from the administrator to Orsi and Zsolt.

Message sent to obali@b2international.com
Message sent to zstorok@b2international.com</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_restrict_user_logins">Restrict user logins</h4>
<div class="paragraph">
<p>Administrator may restrict non-administrator user log in to the sever with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login disabled

Disabled non-administrative logins.</pre>
</div>
</div>
<div class="paragraph">
<p>Users will not be able to connect to the server while non-administrator log in is disabled. Clients will receive the
following when trying to connect to the server from the splash screen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Logging in for non-administrator users is temporarily disabled.</pre>
</div>
</div>
<div class="paragraph">
<p>Invoking this command will not disconnect any of the connected non-administrator users. The way how to disconnect
clients from the server will be discussed below.</p>
</div>
<div class="paragraph">
<p>To re-enable non-administrator log in onto the server refer to the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login enabled

Enabled non-administrative logins.</pre>
</div>
</div>
<div class="paragraph">
<p>The status can be checked with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session login status

Non-administrative logins are currently enabled.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disconnect_users">Disconnect users</h4>
<div class="paragraph">
<p>To disconnect a subset of connected users from the server, the following command should be performed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session disconnect akitta@b2international.com,apeteri@b2international.com

User: akitta@b2international.com ,session id: 3 was disconnected.
User: apeteri@b2international.com ,session id: 6 was disconnected.</pre>
</div>
</div>
<div class="paragraph">
<p>All disconnected users will receive a message about the lost connection. Then client application could be closed
gracefully. This will not prevent users to reconnect the server.</p>
</div>
<div class="paragraph">
<p>The recommended way to ensure that none of the users are connected to the server when performing any single system
administrator task is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disable non-administrator log in in the server</p>
</li>
<li>
<p>Notify users about the upcoming system admin operation</p>
</li>
<li>
<p>Disconnect all users</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_repository_management">Repository management</h3>
<div class="sect3">
<h4 id="_display_terminology_repositories">Display terminology repositories</h4>
<div class="paragraph">
<p>To list all available repositories and their identifiers, one should execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session repositories

   LOINC Store [ID: loincStore]
   Local Code System Store [ID: localterminologyStore]
   Terminology Metadata Store [ID: terminologyregistryStore]
   ICD-10 Store [ID: icd10Store]
   Value Set Store [ID: valuesetStore]
   ATC Store [ID: atcStore]
   SNOMED CT Store [ID: snomedStore]
   Mapping Set Store [ID: mappingsetStore]
   ICD-10-AM Store [ID: icd10amStore]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_display_currently_held_locks">Display currently held locks</h4>
<div class="paragraph">
<p>To view a table of acquired locks, their targets and owners, execute the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session showlocks
No locks are currently granted on this server.

osgi&gt; session lock allrepositories
Acquired lock for all repositories.

osgi&gt; session showlocks

  Id | Lvl | Created on       | Locked area       | Owner context
------------------------------------------------------------------------------------------------------
   0 |   1 | 2014-01-31 21:16 | All repositories  | Lock owner: System
     |     |                  |                   | Performing maintenance from the server console
------------------------------------------------------------------------------------------------------

 osgi&gt; session lock allrepositories
 Acquired lock for all repositories.

  Id | Lvl | Created on       | Locked area       | Owner context
------------------------------------------------------------------------------------------------------
   0 |   2 | 2014-01-31 21:16 | All repositories  | Lock owner: System
     |     |                  |                   | Performing maintenance from the server console
------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>Locks can be acquired for different purposes, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>administrative maintenance</p>
</li>
<li>
<p>backup</p>
</li>
<li>
<p>saving editors</p>
</li>
<li>
<p>classification</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Their area of effect can also vary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all terminology stores</p>
</li>
<li>
<p>a single terminology store</p>
</li>
<li>
<p>a single branch of a particular terminology store</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once a lock owner obtains a lock, the associated area is available for their use only; others will receive indications
that someone else is already working on something which requires uninterrupted access to the target area. Lock attempts
on the same or overlapping areas will not be able to complete until the lock is released.</p>
</div>
<div class="paragraph">
<p>The "Lvl" column indicates the "nesting" count of a granted lock; when someone holds a lock, they can lock the same
area multiple times. Ownership is only released when the level decreases to 0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_lock_and_release_areas_of_terminology_stores">Lock and release areas of terminology stores</h4>
<div class="paragraph">
<p>To lock all terminology stores simultaneously, issue the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session lock allrepositories
Acquired lock for all repositories.</pre>
</div>
</div>
<div class="paragraph">
<p>If a conflicting lock has already been acquired by a different owner, the reason for not granting this request will be
displayed in the response.</p>
</div>
<div class="paragraph">
<p>To lock all branches of a single terminology store, refer to the repository identifiers returned by the
<code>session repositories</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; session lock snomedStore
Acquired lock for repository 'snomedStore'.</pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, for locking a single branch of a single repository, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session lock snomedStore MAIN/a
Acquired lock for branch 'MAIN/a' of repository 'snomedStore'.

osgi&gt; session showlocks

  Id | Lvl | Created on       | Locked area                              | Owner context
-----------------------------------------------------------------------------------------------------------------------------
   0 |   1 | 2014-01-31 21:16 | All repositories                         | Lock owner: System
     |     |                  |                                          | Performing maintenance from the server console
-----------------------------------------------------------------------------------------------------------------------------
   1 |   1 | 2014-01-31 21:30 | Repository 'snomedStore'                 | Lock owner: System
     |     |                  |                                          | Performing maintenance from the server console
-----------------------------------------------------------------------------------------------------------------------------
   2 |   1 | 2014-01-31 21:30 | Branch 'MAIN' of repository 'snomedStore'| Lock owner: System
     |     |                  |                                          | Performing maintenance from the server console
-----------------------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>The branch path argument is case sensitive; as an example, <code>main</code>, <code>Main</code>, <code>main/a</code> and <code>Main/a</code> branch paths would be
invalid arguments.</p>
</div>
<div class="paragraph">
<p>Releasing an owned lock can be performed by executing a corresponding <code>session unlock</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session unlock snomedStore MAIN
Released lock for branch 'MAIN' of repository 'snomedStore'.

osgi&gt; session showlocks

  Id | Lvl | Created on       | Locked area             | Owner context
------------------------------------------------------------------------------------------------------------
   0 |   1 | 2014-01-31 21:16 | All repositories        | Lock owner: System
     |     |                  |                         | Performing maintenance from the server console
------------------------------------------------------------------------------------------------------------
   1 |   1 | 2014-01-31 21:30 | Repository 'snomedStore'| Lock owner: System
     |     |                  |                         | Performing maintenance from the server console
------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Regular save operations try to get the lock for their target repository and branch. If the administrator
has already taken over an area by using the commands above, a dialog will be displayed when the
user tries to save after approx. 5 seconds of waiting for the lock to be granted.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_forcefully_unlock_stuck_locks">Forcefully unlock stuck locks</h4>
<div class="paragraph">
<p>If an operation gets stuck, or otherwise fails to release locks for which the System user is not the owner, other
users may be blocked indefinitely as a result. To resolve the situation, one can forcefully unlock such locks
by referring to their identifier shown in the table:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; session forceunlock 1
Forcefully released lock with identifier 1.

 osgi&gt; session showlocks

  Id | Lvl | Created on       | Locked area             | Owner context
------------------------------------------------------------------------------------------------------------
   0 |   1 | 2014-01-31 21:16 | All repositories        | Lock owner: System
     |     |                  |                         | Performing maintenance from the server console
------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>To forcefully release all locks, use the command with the <code>all</code> argument instead of the identifier.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_supporting_indexes">Supporting indexes</h3>
<div class="paragraph">
<p>Supporting indexes store additional data that is referenced across terminology stores, such as previous choices of
users, bookmarks, and task metadata. Access to these items cannot be locked, however, a consistent snapshot of their
contents can be taken and saved for backup purposes. Snapshots are only kept while the server is running; after a
restart, only the latest data will be available. It is advised to release snapshots straight after a successful backup.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The provided backup script performs the steps below for all available supporting indexes automatically.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_display_supporting_indexes">Display supporting indexes</h4>
<div class="paragraph">
<p>To list all available supporting index identifiers, issue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; index list

Index service identifier
--------------------------------
  previous_picks
  bookmarks
  tasks
--------------------------------</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_create_snapshot">Create snapshot</h4>
<div class="paragraph">
<p>Consistent snapshots can be referenced by their UUIDs, which is displayed when a new snapshot is created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; index createSnapshot tasks
Snapshot '885bded0-5e93-4f20-bdbd-aafd5434a41a' for service 'tasks' has been successfully created.</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_list_snapshots">List snapshots</h4>
<div class="paragraph">
<p>To get the list of currently available snapshots for any supporting index, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; index listSnapshots tasks

Index snapshot identifier
--------------------------------
 885bded0-5e93-4f20-bdbd-aafd5434a41a
--------------------------------</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_list_files_in_snapshots">List files in snapshots</h4>
<div class="paragraph">
<p>To collect all files that make up a particular snapshot, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; index listSnapshotFiles tasks 885bded0-5e93-4f20-bdbd-aafd5434a41a

 Files in snapshot '885bded0-5e93-4f20-bdbd-aafd5434a41a'
--------------------------------
 tasks/_1.si
 tasks/_0.si
 tasks/_1.cfs
 tasks/_1.cfe
 tasks/segments_3
 tasks/_0.cfs
 tasks/_0.cfe
--------------------------------</pre>
</div>
</div>
<div class="paragraph">
<p>Files are displayed relative to the Snow Owl Server installation&#8217;s <code>resources/index</code> folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="_release_created_snapshot">Release created snapshot</h4>
<div class="paragraph">
<p>To unreference files that might only be in use because a snapshot was taken, and free up disk space, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; index releaseSnapshot tasks 885bded0-5e93-4f20-bdbd-aafd5434a41a
Snapshot 885bded0-5e93-4f20-bdbd-aafd5434a41a has been successfully released.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_remote_jobs">Remote jobs</h3>
<div class="paragraph">
<p>Remote jobs are long-running operations intended to be executed on the server; the requesting user&#8217;s client need not
be kept open while the job is active. The result of these computations can be checked immediately, or at a later time,
if the results are still available for review. The administration console provides two commands for listing currently
running remote jobs, and requesting cancellation of these items.</p>
</div>
<div class="sect3">
<h4 id="_display_remote_jobs">Display remote jobs</h4>
<div class="paragraph">
<p>To list all currently scheduled, running, or finished remote jobs, type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code>osgi&gt; remotejobs list

  Id | Description                      | Owner            | Scheduled        | Started          | Status
------------------------------------------------------------------------------------------------------------
   0 | Batch ontology generation        | info@b2intern... | 2014-03-20 11:03 | 2014-03-20 11:03 | Finished
------------------------------------------------------------------------------------------------------------
   1 | Classifying the ontology on MAIN | info@b2intern... | 2014-03-20 11:13 | 2014-03-20 11:13 | Finished
------------------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="paragraph">
<p>(Note that identifiers in the first column can change at any time if, for example, the initiator of the task removes
a completed job from their list.)</p>
</div>
</div>
<div class="sect3">
<h4 id="_cancel_remote_job">Cancel remote job</h4>
<div class="paragraph">
<p>To signal a remote job that it should finish its work at the closest possible occasion without completing it fully,
use the following command with the identifier from the list displayed above. If <code>remotejobs list</code> was not invoked earlier,
the following message will be printed to the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; remotejobs cancel 0
Please retrieve the list of currently scheduled or running jobs first.</pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, when a valid job identifier is given, the following output should appear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>osgi&gt; remotejobs cancel 0
Requesting job 0 to cancel.</pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and an additional invocation of <code>remotejobs list</code> should list the given job&#8217;s status as "Cancel requested".</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Not all remote jobs are able to react to cancel requests.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_administrative_rest_api_reference">Administrative REST API reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_6">Introduction</h3>
<div class="paragraph">
<p>This document provides a list of available REST endpoints, which can be used for taking scripted backups of a Snow Owl Server instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rest_api">REST API</h3>
<div class="paragraph">
<p>The following URLs are exposed to assist the administrator in creating backups without stopping the server (accepted and
produced content type is <code>text/plain</code> in all cases except errors, where an HTML message may be returned):</p>
</div>
<div class="sect3">
<h4 id="_write_access_control_via_repository_locks">Write access control via repository locks</h4>
<div class="ulist">
<ul>
<li>
<p><code>GET /snowowl/admin/repositories</code>&#8201;&#8212;&#8201;Display list of available terminology repositories</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p>none</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: the list of registered repositories by identifier (one per line, separated by LF)</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>200 (OK)</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>POST /snowowl/admin/repositories/lock</code>&#8201;&#8212;&#8201;Lock all terminology repositories for exclusive access</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p><code>timeoutMilis</code> - lock timeout in milliseconds (optional; default is 5 seconds)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: empty response body</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>204 (No Content)</code> - if the operation succeeded</p>
</li>
<li>
<p><code>400 (Bad Request)</code> - if the format or number of expected arguments is incorrect</p>
</li>
<li>
<p><code>409 (Conflict)</code> - if another participant is already holding a lock (eg. a long-running operation has exclusive access)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>POST /snowowl/admin/repositories/unlock</code>&#8201;&#8212;&#8201;Release previously acquired lock on all terminology repositories</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p>none</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: empty response body</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>204 (No Content)</code> - if the lock has been successfully released</p>
</li>
<li>
<p><code>400 (Bad Request)</code> - if releasing the lock fails for some reason (eg. when no lock was held by the system on the specified repository)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>POST /snowowl/admin/repositories/{id}/lock</code>&#8201;&#8212;&#8201;Lock specific repository for exclusive access</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p><code>id</code> (path parameter) - the repository identifier (as returned by the call to the first URL)</p>
</li>
<li>
<p><code>timeoutMilis</code> - lock timeout in milliseconds (optional; default is 5 seconds)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: empty response body</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>204 (No Content)</code> - if the operation succeeded</p>
</li>
<li>
<p><code>409 (Conflict)</code> - if another participant is already holding a lock (eg. a long-running operation has exclusive access)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>POST /snowowl/admin/repositories/{id}/unlock</code>&#8201;&#8212;&#8201;Release previously acquired lock on specific repository</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p><code>id</code> (path parameter) - the repository identifier</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: empty response body</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>204 (No Content)</code> - if the lock has been successfully released</p>
</li>
<li>
<p><code>400 (Bad Request)</code> - if the format or number of expected arguments is incorrect, or if releasing the lock fails
for some reason (eg. when no lock was held by the system on the specified repository)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_user_notification">User notification</h4>
<div class="ulist">
<ul>
<li>
<p><code>POST /snowowl/admin/messages/send</code>&#8201;&#8212;&#8201;Send a message to connected users</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p><code>message</code> - the message to send</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: empty response body</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>400 (Bad Request)</code> - if the format or number of expected arguments is incorrect</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_versioning_and_terminology_indexes">Versioning and terminology indexes</h4>
<div class="ulist">
<ul>
<li>
<p><code>GET /snowowl/admin/repositories/{id}/versions</code>&#8201;&#8212;&#8201;Display list of registered versions for the specified repository</p>
<div class="ulist">
<ul>
<li>
<p>Parameters:</p>
<div class="ulist">
<ul>
<li>
<p><code>id</code> (path parameter) - the repository identifier</p>
</li>
</ul>
</div>
</li>
<li>
<p>Returns: the list of versions for the specified repository (one per line, separated by LF; always including <code>MAIN</code>
as a placeholder for the mainline of the repository, from which a version may be created later)</p>
</li>
<li>
<p>Responses:</p>
<div class="ulist">
<ul>
<li>
<p><code>200 (OK)</code> - if the operation succeeded</p>
</li>
<li>
<p><code>404 (Not Found)</code> - if a repository with the given identifier could not be found
= SNOMED CT Extension management</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_introduction_7">Introduction</h3>
<div class="paragraph">
<p>Snow Owl is capable of managing multiple SNOMED CT extensions on a single server. This document highlights how each extension is managed in a dedicated area and lists the main authoring scenarios.  Similarly to generic SNOMED CT authoring, content is developed via the help of a workflow where the work performed on a task is promoted to the repository after review.  Promoting (donating) content from an extension to the international content or between extensions is not supported.  Extension authors can follow their own release schedule and extension content can be versioned at any time during the authoring process. Extensions are based on a single international release version. The base international release can be upgraded underneath the extension content. Extensions do not have an additional isolated area for long running development projects (project branch). The import and export of standard RF2 serialized content is supported.
The international content is not edited on the server, only updated via delta releases as consecutive releases are available from IHTSDOs own authoring process. Search will be performed for both the native language and English as is currently supported. There will be no special search features to accommodate specific language requirements, such as word decompoundization.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/snomed_extensions.png" alt="snomed extensions">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_branching_arrangement">Branching arrangement</h3>
<div class="paragraph">
<p>The implemented branching arrangement closely follows the current branching preferences where the international release is imported onto the MAIN branch and each Member Country will have a dedicated branch for the extension content.  The only commits on the MAIN branch are the contents of the delta release for a particular version. These commit points are versioned during the import process. The dedicated branch will be forked off the MAIN branch at the point representing the base international release as shown in Figure 1.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/extension_authoring.png" alt="extension authoring">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_versioning">Versioning</h3>
<div class="paragraph">
<p>The extension content is marked with a version tag for future reference with a new empty branch. All new components will receive an effective time.</p>
</div>
</div>
<div class="sect2">
<h3 id="_upgrading_downgrading">Upgrading/Downgrading</h3>
<div class="paragraph">
<p>Upgrading means to increase the version of the base international release. During the upgrade process, the current extension branch is forward-rebased via creating a new branch and copying over the entire content as a single commit. As shown in Figure 2, the V1 and V2 versioned content is based on the 2016.01.01, whereas the V3 version is based on the 2016.06.01 version of the international release. The main advantage is that the old branch still maintains the earlier versions of the extension, this way the version dependencies between the extension and international release can be implicitly represented via the branches. If the user decides to switch back to the read-only older V1 version, content is properly displayed with international content from 2016.01.01. To avoid content with incorrect dependencies, only versioned extensions should be allowed to be upgraded. Downgrading means to decrease the version of the base international release. The same process described above for upgrade applies.</p>
</div>
</div>
<div class="sect2">
<h3 id="_international_version_update">International version update</h3>
<div class="paragraph">
<p>When new international release is available, the corresponding delta is imported onto the MAIN branch.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_provisioning_example_for_a_single_extension">Data provisioning example for a single extension</h3>
<div class="paragraph">
<p>The following example demonstrates how a blank server is provisioned for extension management.  The example is carried out using both the command line OSGi interface as well as the REST API.</p>
</div>
<div class="sect3">
<h4 id="_osgi_command_line_interface">OSGi command line interface</h4>
<div class="paragraph">
<p>First, the full International Release is imported with version tags created (<em>-v</em>). The selected Language Refset is English.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; sctimport rf2_release -t full -v /path/to/SnomedCT_RF2Release_INT_20160131.zip /path/to/snomed_ct_international.json</pre>
</div>
</div>
<div class="paragraph">
<p>Where the <code>snomed_ct_international.json</code> release descriptor file is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Systematized Nomenclature of Medicine Clinical Terms International Version</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">shortName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ENG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">codeSystemOID</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2.16.840.1.113883.6.96</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">maintainingOrganizationLink</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.ihtsdo.org</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">citation</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMED CT contributes to the improvement of patient care by underpinning the development of Electronic Health Records that record clinical information in ways that enable meaning-based retrieval. This provides effective access to information required for decision support and consistent reporting and analysis. Patients benefit from the use of SNOMED CT because it improves the recording of EHR information and facilitates better communication, leading to improvements in the quality of care.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the import process, to check the terminology registry issue the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; terminologyregistry listall</pre>
</div>
</div>
<div class="paragraph">
<p>To see all the version branches created execute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; snowowl listbranches snomedStore</pre>
</div>
</div>
<div class="paragraph">
<p>To import an extension terminology based on the <em>2016-01-31</em> International release, issue the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; sctimport rf2_release -t full -b 2016-01-31 -v /path/to/SnomedCT_Extension_Release.zip /path/to/snomed_ct_extension.json</pre>
</div>
</div>
<div class="paragraph">
<p>Where the <code>snomed_ct_extension.json</code> release descriptor file is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">B2i Healthcare SNOMED CT extension</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">shortName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT_B2i</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">language</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ENG</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">codeSystemOID</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2.16.840.1.113883.6.961</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">extensionOf</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">SNOMEDCT</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">maintainingOrganizationLink</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.b2i.sg</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">citation</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">This is an example SNOMED CT extension by B2i Healthcare.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, after the import process, to check the terminology registry issue the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; terminologyregistry listall</pre>
</div>
</div>
<div class="paragraph">
<p>To see all the version branches created execute:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; snowowl listbranches snomedStore</pre>
</div>
</div>
<div class="paragraph">
<p>There should be a branch named <em>MAIN/2016-01-31/SNOMEDCT_B2i</em> dedicated for the initial content of the extension.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rest_api_2">REST API</h4>
<div class="paragraph">
<p>Importing the terminology and creating an entry in the terminology registry require two separate REST endpoints to be invoked.</p>
</div>
<div class="paragraph">
<p>Upload the import configuration:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports
{
  "createVersions": true,
  "type": "FULL",
  "branchPath": "MAIN",
  "codeSystemShortName": ""
}</pre>
</div>
</div>
<div class="paragraph">
<p>Note: For backward compatibility, missing or empty <em>codeSystemShortName</em> result in a SNOMED CT International Release entry in the terminology registry, no explicit operation is required.</p>
</div>
<div class="paragraph">
<p>Import the International archive:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports/{importId}/archive</pre>
</div>
</div>
<div class="paragraph">
<p>After the import process, check the terminology registry for the entry representing the International release:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /snowowl/admin/codesystems</pre>
</div>
</div>
<div class="paragraph">
<p>Create new branch for extension:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/branches
{
  "metadata": {},
  "parent": "MAIN/2016-01-31",
  "name": "Extension_branch"
}</pre>
</div>
</div>
<div class="paragraph">
<p>To check the branch created (<em>MAIN/2016-01-31/Extension_branch</em>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /snowowl/snomed-ct/v2/branches</pre>
</div>
</div>
<div class="paragraph">
<p>Create new Code System for the extension. The extension will initially be based on the <em>2016-01-31</em> International release:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/admin/codesystems
{
	"oid": "2.16.840.1.113883.6.961",
	"name": "B2i Healthcare SNOMED CT extension",
	"shortName": "SNOMEDCT_B2i",
	"organizationLink": "http://www.b2i.sg",
	"primaryLanguage": "ENG",
	"citation": "This is an example SNOMED CT extension by B2i Healthcare.",
	"iconPath": "icons/b2i_extension_icon.png",
	"terminologyId": "com.b2international.snowowl.terminology.snomed",
	"repositoryUuid": "snomedStore",
	"branchPath": "MAIN/2016-01-31/Extension_branch",
	"extensionOf": "SNOMEDCT"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Check the terminology registry for the extension entry:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /snowowl/admin/codesystems</pre>
</div>
</div>
<div class="paragraph">
<p>Upload import configuration for extension import:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports
{
  "createVersions": true,
  "type": "DELTA",
  "branchPath": "MAIN/2016-01-31/Extension_branch",
  "codeSystemShortName": "SNOMEDCT_B2i"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Import the extension:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports/{importId}/archive</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_versioning_extension_content">Versioning extension content</h4>
<div class="paragraph">
<p>There is no command-line command available for versioning, the functionality is only accessible via the REST interface:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/admin/codesystems/SNOMEDCT_B2i/versions
{
  "version": "Extension:2016-06-01",
  "description": "Extension test version",
  "effectiveDate": "20160601"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_upgrading_extension_content">Upgrading extension content</h4>
<div class="paragraph">
<p>There is no command-line command available for upgrading, the functionality is only accessible via the REST interface.</p>
</div>
<div class="paragraph">
<p>Import the new International DELTA archive to the MAIN branch in two steps:</p>
</div>
<div class="paragraph">
<p>First create the import configuration.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports
{
  "createVersions": true,
  "type": "DELTA",
  "branchPath": "MAIN",
  "codeSystemShortName": "SNOMEDCT"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then upload the archive to start the import.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports/{importId}/archive</pre>
</div>
</div>
<div class="paragraph">
<p>After the import process, create a new branch for extension:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/branches
{
  "metadata": {},
  "parent": "MAIN/2016-07-31",
  "name": "Extension_branch"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then copy over the entire content onto the target extension branch. If the merge fails because of conflicts, fix the errors and then try again.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/merges
{
  "source": "MAIN/2016-01-31/Extension_branch",
  "target": "MAIN/2016-07-31/Extension_branch",
  "commitComment": "Upgrade extension content."
}</pre>
</div>
</div>
<div class="paragraph">
<p>The above call will return the unique ID of the merge process which can be used to poll its status (e.g. <em>IN_PROGRESS</em>, <em>COMPLETED</em>, <em>CONFLICTS</em>, etc).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /snowowl/snomed-ct/v2/merges/{mergeId}</pre>
</div>
</div>
<div class="paragraph">
<p>Finally update the branch path of the extension Code System to point to the target extension branch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PUT /snowowl/admin/codesystems/SNOMEDCT_B2i
{
  "repositoryUuid": "snomedStore",
  "branchPath": "MAIN/2016-07-31/Extension_branch"
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_downgrading_extension_content">Downgrading extension content</h4>
<div class="paragraph">
<p>There is no command line command available for downgrading, the functionality is only accessible via the REST interface.</p>
</div>
<div class="paragraph">
<p>Copy over the current extension content onto the target extension branch. If the merge fails because of conflicts, fix the errors and then try again.</p>
</div>
<div class="paragraph">
<p>If no new content was added to the current branch since the merge, you can skip this step.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/merges
{
  "source": "MAIN/2016-07-31/Extension_branch",
  "target": "MAIN/2016-01-31/Extension_branch",
  "commitComment": "Downgrade extension content."
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then update the branch path of the extension Code System to point to the target extension branch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PUT /snowowl/admin/codesystems/SNOMEDCT_B2i
{
  "repositoryUuid": "snomedStore",
  "branchPath": "MAIN/2016-01-31/Extension_branch"
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_snomed_ct_swedish_extension_management_example">SNOMED CT Swedish Extension management example</h3>
<div class="paragraph">
<p>The following example demonstrates how a blank server is provisioned for the Swedish extension management through the REST API.</p>
</div>
<div class="paragraph">
<p>First create the import configuration for the International release.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports
{
  "createVersions": true,
  "type": "FULL",
  "branchPath": "MAIN",
  "codeSystemShortName": "SNOMEDCT"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Then upload the RF2 archive file to start the import.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports/{importId}/archive</pre>
</div>
</div>
<div class="paragraph">
<p>After the import process, create a new branch for the Swedish extension which is based on version 2015-01-31.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/branches
{
  "metadata": {},
  "parent": "MAIN/2015-01-31",
  "name": "SNOMEDCT-SE"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Create a new Code System for the Swedish extension. The branch path points to the previously created branch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/admin/codesystems
{
	"oid": "2.16.840.1.113883.6.962",
	"name": "SNOMED CT Swedish Extension",
	"shortName": "SNOMEDCT-SE",
	"organizationLink": "http://www.socialstyrelsen.se/",
	"primaryLanguage": "SWE",
	"citation": "SNOMED CT contributes to the improvement of patient care by underpinning the development of Electronic Health Records that record clinical information in ways that enable meaning-based retrieval. This provides effective access to information required for decision support and consistent reporting and analysis. Patients benefit from the use of SNOMED CT because it improves the recording of EHR information and facilitates better communication, leading to improvements in the quality of care.",
	"iconPath": "icons/snomed.png",
	"terminologyId": "com.b2international.snowowl.terminology.snomed",
	"repositoryUuid": "snomedStore",
	"branchPath": "MAIN/2015-01-31/SNOMEDCT-SE",
	"extensionOf": "SNOMEDCT"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Create the import configuration for the Swedish import.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports
{
  "createVersions": true,
  "type": "FULL",
  "branchPath": "MAIN/2015-01-31/SNOMEDCT-SE",
  "codeSystemShortName": "SNOMEDCT-SE"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Upload the Swedish RF2 archive file to start the extension import.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/imports/{importId}/archive</pre>
</div>
</div>
<div class="paragraph">
<p>Create a new branch based on version 2016-01-31. The Swedish extension will be merged onto this branch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/branches
{
  "metadata": {},
  "parent": "MAIN/2016-01-31",
  "name": "SNOMEDCT-SE"
}</pre>
</div>
</div>
<div class="paragraph">
<p>Start a merge to upgrade the extension content onto the previously created branch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>POST /snowowl/snomed-ct/v2/merges
{
  "source": "MAIN/2015-01-31/SNOMEDCT-SE",
  "target": "MAIN/2016-01-31/SNOMEDCT-SE",
  "commitComment": "Upgrade Swedish extension to international version 2016-01-31"
}</pre>
</div>
</div>
<div class="paragraph">
<p>The POST operation will return a <em>mergeId</em> that can be used to monitor the progress of the merge via:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GET /snowowl/snomed-ct/v2/merges/{mergeId}</pre>
</div>
</div>
<div class="paragraph">
<p>Which operation will return with failed status and the following conflicts:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Relationship with ID '6271000052128' has a conflict of type 'HAS_INACTIVE_REFERENCE' on target branch, conflicting attributes are: [destinationId -&gt; 373245004].
Relationship with ID '16741000052126' has a conflict of type 'HAS_INACTIVE_REFERENCE' on target branch, conflicting attributes are: [destinationId -&gt; 373245004].
Relationship with ID '44001000052128' has a conflict of type 'HAS_INACTIVE_REFERENCE' on target branch, conflicting attributes are: [destinationId -&gt; 237968007].
Relationship with ID '1929491000052120' has a conflict of type 'HAS_INACTIVE_REFERENCE' on target branch, conflicting attributes are: [destinationId -&gt; 237968007].</pre>
</div>
</div>
<div class="paragraph">
<p>After fixing the conflicts, start another merge (same as before) and then update the branch path of the Swedish Code System.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PUT /snowowl/admin/codesystems/SNOMEDCT-SE
{
  "repositoryUuid": "snomedStore",
  "branchPath": "MAIN/2016-01-31/SNOMEDCT-SE"
}</pre>
</div>
</div>
<div class="sect3">
<h4 id="_developer_notes">Developer notes</h4>
<div class="paragraph">
<p>During the upgrade/downgrade process, conflicts are identified between the terminology to be upgraded/downgraded and the international release.  Using the <strong>mergeConflictRuleProvider</strong> extension point, rule providers can be registered the provide conflict rules. The currently registered rule provider is <strong>com.b2international.snowowl.datastore.server.snomed.merge.SnomedMergeConflictRuleProvider.java</strong>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-01-10 11:31:54 CET
</div>
</div>
</body>
</html>